
;****************************************************************************
;*                                                                          *
;*                   MoonBlaster for MoonSound Wave driver                  *
;*                                                                          *
;* Authors :Remco Schrijvers      : Main coding                             *
;*         :Arjan Bakker          : Speed-improvement, adding pseudo-       *
;*                                  reverb and extra drums (v. 1.04)        *
;*                                  Adding LFO-handling (v. 1.05)           *
;*                                   (No full support, just standard values *
;*                                  Sample header improvements (v. 1.06)    *
;*                                  Own Waves (v. 1.07)                     *
;****************************************************************************

;--- Defines ---

LFO:            equ     1	; LFO mogelijk (weglaten scheelt wat ruimte)
FADE:		equ     1	; FADE mogelijk?
EQUAL_SPEED:	equ	0

WVIO:           equ     07eh    ; wave I/O base port
FMIO:           equ     0c4h
PTW_SIZE:       equ     20      ; size of Wave playtable line
WAVCHNS:        equ     24      ; aantal kanalen

OWNWAVES:       equ     32      ; aantal mogelijke Own Wave instrumenten
OWNTONES:       equ     48      ; aantal mogelijke eigen samples

depopcom_special:	equ	#0112
v_freq:			equ	#ffe8
;replayer_page:  equ     8

;--- extra assembly commands ---

add_hl_a:       macro   ; add A to HL
	        add     a,l     ; notice: A is modified!
	        jr      nc,add@$YM
	        inc     h
add@$YM:        ld      l,a
        	endm

add_de_a:       macro   ; add A to DE
	        add     a,e     ; notice: A is modified!
	        jr      nc,add@$YM
	        inc     d
add@$YM:        ld      e,a
       		endm

		include	macros.gen

        	org     08000h

;entries
entries1:
	        jp      start_music     ;#8000
	        jp      stop_music      ;#8003
	        jp      play_int        ;#8006
	        jp      initOPL4        ;#8009
	        jp      play_sfx	;#800c
	  	jp      play_all        ;#800f
	  	jp	silence		;#8012

songdata_adres: defw    #4000   ; #8015 - #8016
songdata_bank1: defb    4       ; #8017
current_FD:     defb    0       ; #8018
		nop
play_busy:      defb    0       ; #801a
                defw    tones_data      ; #801b - #801c
                defw    waves           ; #801d - #801e
                defb    0       ; #801f
play_pos:       defb    0       ; #8020
play_step:      defb    0       ; #8021
status:         defb    0,0,0   ; #8022 - #8024
step_buffer:    defs    25    ; #8025 - #803d
play_fading:    defb    0	;#803e

;In: A: number of channels
set_channels:   push	af

		ld	(init_voices + 1),a
		ld	(play_int6 + 1),a
		ld	(play_int_3rd_a + 1),a
		ld	(play_pitch0 + 1),a
		ld	(halt_music0 + 1),a
		ld	(channels_off + 1),a
		IF	FADE=1
		ld	(play_fade0 + 1),a
		ENDIF
		
		srl	a
		ld	(decr_step_end0 + 2),a
		ld	(play_int_secit1 + 2),a
		
		push	af
		ld	c,a
		ld	b,0
		ld	de,PTW_SIZE
		call	muluw
		ld	de,play_table_wav
		add	hl,de
		ld	(play_int_secit + 2),hl
		
		pop	af
		ld	hl,step_buffer
		ADD_HL_A
		ld	(play_int_secit0 + 1),hl

		pop	af
		
		cp	16
		ld	a,2
		LDNZ	a,3
		ld	(decr_step_2a + 1),a
		
		ld	a,0             ;nop
		LDNZ	a,%00100011	;inc	hl
		ld	(decr_step_2b),a
		
		LDNZ	a,%00011001	;add	hl,de
		ld	(start_music1),a
		ret


initOPL4:       ld      a,5
                out     (#c6),a
                ld      a,3
                out     (#c7),a

; Initialiseer OPL4 om te lezen/schrijven
                ld      e,#20
                ld      hl,OWNTONES * 12
setSRAMacces:   ld      bc,256 * 17 + 2
                call    wave_out          ; Memory Acces mogelijk
                ld      b,e
                ld      c,3
                call    wave_out
                ld      b,h
                inc     c
                call    wave_out
                ld      b,l
                inc     c
                call    wave_out
                ld      a,6
                out     (#7e),a

                ld      hl,cymball
                ld      b,12    ; 12 bytes verplaatsen
move_headers1:  in      a,(#c4)
                and     1
                jr      nz,move_headers1
                ld      a,(hl)
                inc     hl
                out     (#7f),a
                djnz    move_headers1
                ret

; Schrijf waarde naar register
wave_out:       ld      a,c
                out     (#7e),a
		nop
                ld      a,b
                out     (#7f),a
                ret

; cymball - 400
cymball:     	defb    70,120,216,18,126,181,165,      0,244,242,6,0



;-------------------------------- PLAYROUTINE --------------------------------


;--------------------
;--- Start music ---
;--------------------
; In : HL: music start adres
; Out: -
; Mod: all

start_music:
        	ld      a,(play_busy)
        	or      a
        	ret	nz

		push	hl

        	xor	a
        	ld	(music_on_int),a
;		ld	(#8015),hl

        	call    silence

        	ld      hl,0
        	ld      (status),hl
       	 	ld      (status+1),hl   ; clear status bytes
        	ld      (play_fadecnt),hl       ; fade counter 1 en 2 op 0

		IF	EQUAL_SPEED = 1
		xor	a
		ld	(v_freq_counter),a
        	dec	a	; A wordt 255
		ENDIF

		IF	EQUAL_SPEED = 0
		ld	a,255
		ENDIF
        	ld      (play_busy),a   ; set busy playing (255)
        	ld      (play_pos),a    ; set position (255)
        	ld      a,15
        	ld      (play_step),a   ; set step (15)


		pop	hl
		call	depopcom_special
	        
	  	READ_FD
        	push	af

        	ld      a,(songdata_bank1)
        	WRITE_FD		; bank met songdata selecteren
		ld	hl,#4000
		ld	(#8015),hl

	        ld      hl,(songdata_adres)
	        ld      de,6
	        add     hl,de
	        ld      (songdata_adres),hl
	        ld      de,xleng
	        ld      bc,220
	        ldir            ; copy song settings
	        ld      de,58
start_music1:   add     hl,de   ; skip name/wavekit
	        ld      (pos_address),hl
	        ld      a,(xleng)
	        inc     a
	        ld      e,a
	        ld	d,0
	        add     hl,de
	        ld      (pat_address),hl

	        call    init_opl4       ; initialise OPL4
	        call    init_voices     ; set start voices
	        ld      a,(xtempo)
	        ld      (play_speed),a  ; set tempo
	        ld      a,(play_speed)
	        sub     3
	        ld      (play_timercnt),a ; initialise timer (tempo)
	        xor     a
	        ld      (play_tspval),a ; transpose off
		IF	FADE
	        ld      (play_fading),a ; fading uit
		ENDIF
		
		call	init_lfo
	        call    copy_waves
	        call    init_opl4
	        
	        ld	a,255
	        ld	(music_on_int),a
	
	        pop	af
		WRITE_FD
	        ret

;initialiseer lfo-waarden (note: songs moeten dus XLFO-label hebben!)
init_lfo:	ld	hl,(pos_address)	;adres positiontable
		ld	a,(xleng)		;songlength
		ld	b,a
		ld	c,0			;highest patternno found
init_lfo_spat_lp:				;search highest pattern
		ld	a,(hl)
		cp	c	;pattern# groter dan hoogste tot nu toe gevonden?
		jr	c,init_lfo_spat_nt	;carry->nee
		ld	c,a		;nieuwe hoogste pattern#
init_lfo_spat_nt:
		djnz	init_lfo_spat_lp
		ld	a,c
		add	a,a
		ld	hl,(pat_address)
		add_hl_a	;adres hoogste pattern
init_lfo_sxlfo_lp:	;search 'XLFO'
		push	hl
		ld	a,(hl)
		cp	'X'
		jr	nz,init_lfo_sxlfo_nt
		inc	hl
		ld	a,(hl)
		cp	'L'
		jr	nz,init_lfo_sxlfo_nt
		inc	hl
		ld	a,(hl)
		cp	'F'
		jr	nz,init_lfo_sxlfo_nt
		inc	hl
		ld	a,(hl)
		cp	'O'
		jr	nz,init_lfo_sxlfo_nt
		inc	hl	;finally found!
		ld	de,table_lvt
		ld	bc,18
		ldir	;transfer XLFO-data
		pop	hl
		ret

init_lfo_sxlfo_nt:
		pop	hl
		inc	hl
		jr	init_lfo_sxlfo_lp


;--- initialise OPL4 registers ---

init_opl4:      ld      a,3
	        ld      c,5
	        call    opl4_out_bnk1   ; Set the OPL4 in OPL4 mode
	
	        ld      c,2
	        ld      a,10000b
	        jp      opl4_out_wave   ; init Wave ROM stuff

;----------------
;--- OPL4 out ---
;----------------

opl4_out_bnk1:  ex      af,af'
                ld      a,c
                out     (FMIO + 2),a
                ex      af,af'
                nop
                out     (FMIO + 1),a
                ret

opl4_out_wave:  ex      af,af'
                ld      a,c
                out     (WVIO),a
                ex      af,af'
                nop
                out     (WVIO+1),a
                ret

opl4_in_wave:
                ld      a,c
                out     (WVIO),a
                nop
                nop
                in      a,(WVIO+1)
                ret


;----------------------------
;--- Stel Start Voices in ---
;----------------------------

init_voices:    ld      b,WAVCHNS       ; # wave channels
	        ld      iy,play_table_wav
	        ld      ix,xbegwav
	        ld      de,PTW_SIZE
init_wavesl:    push    de
	        push    bc
	        ld      a,(ix - 72)     ; xdetune!
	        add     a,a
	        ld      (iy + 5),a      ; detune!
	
	        ld      a,(ix + 0)      ; wave/patchnr
	        push    af
	        ld      (iy + 2),0      ; pb/mod off
	        ld      (iy + 12),0     ; pseudo reverb off
	        call    play_wwavevt2
	        pop     af
	        ld      hl,xwavvols - 1
	        add_hl_a
	        ld      a,(hl)  ; volume
	        ld      (iy + 15),a
	        call    play_wchgvol2
	        ld      a,(ix - 98)      ; stereo preset
	        call    play_wchgste2
	        inc     ix
	        pop     bc
	        pop     de
	        add     iy,de
	        djnz    init_wavesl
	        ret

;--------------------
;--- Stop muziek ----
;--------------------
; In : -
; Out: -
; Mod: all
stop_music:

;------------------
;--- Halt music ---
;------------------

halt_music:     ld      a,(play_busy)   ; already stopped?
	        or      a
	        ret     z 
	        
		di
	        xor     a
	        ld      (play_busy),a
	        ld	(music_on_int),a
	        
halt_music0:	ld      b,WAVCHNS       ; # wave channels
	        ld      iy,play_table_wav
	        ld      de,PTW_SIZE
halt_musicl3:   call    play_woffevt1
	        call    play_chgdmp1
	        add     iy,de
	        djnz    halt_musicl3
	
	        ei
		jp	    restore_tones



;-------------------------------
;--- Music interrupt routine ---
;-------------------------------

v_freq_counter:	defb	0

play_int:	ld      a,(play_busy)
	        or      a
	        ret     z

		ld	a,(music_on_int)
		or	a
		ret	z

		IF	EQUAL_SPEED = 1
		ld	a,(v_freq)
		cp	60
		jr	nz,play_int_start	;geen 60 hz -> geen interrupts overslaan

		ld	a,(v_freq_counter)
		inc	a
		ld	(v_freq_counter),a
		cp	6	;6e keer?
		jr	nz,play_int_start	;nee? -> gewoon muziek afspelen
		xor	a
		ld	(v_freq_counter),a
		ret
		ENDIF

play_int_start:
	        READ_FD
	        ld      (current_FD),a

play_int3:

        	call    play_pitch      ; pitch-bend/modulation handler

		IF	FADE
	        ld      a,(play_fading)
	        or      a
	        jr      z,play_int5
	        call    play_fade       ; fading
	        ld      a,(play_fading)
	        or      a
	        jp      z,play_int_end
		ENDIF

play_int5:      ld      a,(play_speed)  ; speed
	        ld      hl,play_timercnt
	        inc     (hl)
	        cp      (hl)
	        jr      nz,play_int_sec ; almost there?
	        ld      (hl),0
	
	        ld      hl,step_buffer  ; songdata-adres
	        ld      iy,play_table_wav
play_int6:      ld      b,WAVCHNS       ; # Wave channels!
play_int_wlus:  ld      a,(hl)
	        or      a
	        jr      z,play_int_wend2        ; empty
	
	        ex      af,af'
	        ld      a,b
	        exx
	        ld      b,a     ;channel
	        ex      af,af'

	        cp      97
	        jp      c,play_wonevt   ; wave on
	        jp      z,play_woffevt  ; wave off
	        cp      146
	        jp      c,play_wwavevt  ; wave
	        cp      178
	        jp      c,play_wchgvol  ; volume
	        cp      193
	        jp      c,play_wchgste  ; stereo
	        cp      212
	        jp      c,play_wlnk     ; link
	        cp      231
	        jp      c,play_wchgpit  ; pitch bending
	        cp      238
	        jp      c,play_wchgdet  ; detune
	        cp      241
	        jp      c,play_wchgmod  ; modulation
	        jp      z,play_revon    ; pseudo reverb on
	        cp      242
	        jp      z,play_chgdmp   ; damp
	        cp      244
	        IF      LFO
	        jp      c,play_lfo      ; lfo switch
	        ENDIF
	        jp      z,play_revoff   ; pseudo reverb off
	        IF      LFO
	        jp      play_chglvt     ; LFO/VIBRATO/TREMOLO
	        ENDIF

play_int_wend:  exx
play_int_wend2:

	        add     iy,de
	        inc     hl
	        djnz    play_int_wlus

;        	IF      WAVCHNS < 24
;        	ld      de,24 - WAVCHNS ;verschuif pointer naar CMD-byte
;        	add     hl,de
;        	ENDIF

	        ld      a,(hl)  ; command line
	        or      a
	        jr      z,play_cmdcnt

	        cp      24
	        jp      c,play_chgtmp   ; change tempo
	        jp      z,play_endop    ; end of pattern
	        cp      28
	        jr      c,play_cmdcnt   ; status
	        jp      play_chgtrs   ; transpose
play_cmdcnt:
play_int_fin:

play_int_end:   ld      a,(current_FD)
	  	WRITE_FD
        	ei
        	ret


;-----------------------------------------------
;--- Interrupt routine BEFORE play-interrupt ---
;-----------------------------------------------

play_int_sec:   dec     a
	        ld      b,a
	        ld      a,(songdata_bank1)
		WRITE_FD
	        ld      a,b
	
	        cp      (hl)
	        jr      z,play_int_secit
	        dec     a
	        cp      (hl)
	        jr      nz,play_int_fin

play_int_3rd:   ld      a,(play_step)           ; increase current step
	        inc     a
	        and     01111b
	        ld      (play_step),a
	        ld      hl,(songdata_ptr)
	        call    z,play_nextpos          ; step 0 => new position


;--- decrunch one step ---

	        ld      de,step_buffer
	        ld      a,(hl)
	        inc     hl
	        cp      0ffh    ; 0FFh => completely empty
	        jr      nz,decr_step_2
	        exx
	        ld      hl,step_buffer
	        ld      de,step_buffer + 1
play_int_3rd_a:	ld      bc,WAVCHNS      ; kanalen - 1 (first already filled)
	        ld      (hl),b
	        ldir
	        ld      a,b
	        ld      (step_buffer + 24),a
	        exx
	        jr      decr_step_end

decr_step_2:    ld      (de),a  ; 1st byte uncrunched
	        inc     de
	        push    hl
	        inc     hl
	        inc     hl
decr_step_2b:	inc     hl	;nop when using 16 channels
	        exx
	        pop     hl
decr_step_2a    ld      b,2     ; decrunch 3 * 8 bytes
decr_step_lp1:  ld      a,(hl)
	        exx
	        ld      b,8     ; decrunch 8 bytes
	        ld      c,a
decr_step_lp2:  xor     a
	        rlc     c
	        jr      nc,decr_step_3  ; no carry? then empty event
	        ld      a,(hl)
	        inc     hl
decr_step_3:    ld      (de),a
	        inc     de
	        djnz    decr_step_lp2
	        exx
	        inc     hl
	        djnz    decr_step_lp1
	        exx
decr_step_end:  ld      (songdata_ptr),hl

;--- Calculate freq. & note nr of wave to play ---

		ld	hl,step_buffer
channels_off:	ld	b,WAVCHNS
channels_off_loop:
		ld	a,(hl)
		dec	a
		cp	96
		call	c,play_woffevt1	
		inc	hl	
		djnz	channels_off_loop		

	        ld      iy,play_table_wav
	        ld      hl,step_buffer  ; third interrupt
decr_step_end0:	ld      bc, 256 * (WAVCHNS/2) + 96
	        jr      play_int_seclp

play_int_secit:	ld      iy,play_table_wav + (WAVCHNS/2) * PTW_SIZE
play_int_secit0:        ld      hl,step_buffer + WAVCHNS / 2   ; second interrupt
play_int_secit1:        ld      bc, 256 * (WAVCHNS/2) + 96

play_int_seclp: ld      de,PTW_SIZE
play_int_secwl: ld      a,(hl)
	        dec     a
	        cp      c       ; 96
	        jr      c,calc_wave

play_int_secwe: add     iy,de
	        inc     hl
	        djnz    play_int_secwl
	        jp      play_int_fin

;--- calc wave stuff ---

calc_wave:  
		exx
	        ld      d,a
	        ld      hl,patch_table  ; dit stuk verandert A niet!
	        ld      c,(iy + 10)
	        ld      a,c
	        cp      175
	        jp      z,calc_drm      ; gm drum patch
	        cp      176
	        jp      nc,calc_own     ; Own Waves

calc_drm_cnt:   ld      b,0
                ld      a,d
	        add     hl,bc
	        add     hl,bc
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)  ; pointer to patch
	        ex      de,hl
	        ld      e,(hl)
	        inc     hl

	        srl     e       ; transpose
	        jr      nc,keyb_wonwav7
	        ld      b,a
	        ld      a,(play_tspval)
	        add     a,b
	        ld      b,0

keyb_wonwav7:   ld      de,3 + 2

calc_wave_lp:   cp      (hl)
	        jr      c,calc_wave_2
	        ld      b,(hl)
	        add     hl,de
	        cp      (hl)    ; 4 * the same, saves 30 T-states!
	        jr      c,calc_wave_2   ; (Anything for some extra speed)
	        ld      b,(hl)
	        add     hl,de
	        cp      (hl)
	        jr      c,calc_wave_2
	        ld      b,(hl)
	        add     hl,de
	        cp      (hl)
	        jr      c,calc_wave_2
	        ld      b,(hl)
	        add     hl,de
	        jr      calc_wave_lp
calc_wave_2:    ld      d,a     ; save note...
	        inc     hl
	        ld      a,(hl)  ; low byte tone
	        ld      (iy + 7),a
	
	        inc     hl
	        ld      a,(hl)
	        and     1       ; also resets carry!
	        ld      (iy + 6),a      ; high byte tone
	
	        ld      a,(hl)  ; tone-note
	        rra             ; note that carry was set 0 earlier!!
	        add     a,d
	        sub     b
	        ld      (iy + 0),a      ; last note
	
	        inc     hl
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)
	        ld      (iy + 17),d     ; pointer to freqtab
	        ld      (iy + 16),e
	
	        ld      hl,tabdiv12
	        ld      c,a
	        ld      b,0
	        add     hl,bc
	        add     hl,bc
	        ld      c,(hl)
	        inc     hl
	        ld      a,(hl)

	        ld      l,a
	        ld      h,b     ;B=0
	        add     hl,de
	
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)  ; DE = freq
	
	        sla     e       ; freq fine
	        ld      a,d
	        rla             ; freq rotated 1 left
	        add     a,c     ; octave
	
	        ld      d,a     ; high byte freq
	
	        ld      h,b     ; LD H,0!
calc_drmcnt2:   ld      l,(iy + 5)
	        bit     7,l
	        jr      z,calc_wave_6
	        dec     h
	        add     hl,hl   ; detune...
calc_wave_7:    add     hl,de
	        res     3,h
	        ld      (iy + 8),l      ; freq fine
	        ld      (iy + 9),h
	        exx             ; Yes! Finally, finished...
	        jp      play_int_secwe
calc_wave_6:    ex      de,hl
	        add     hl,de   ; detune...
	        ld      d,1000b
	        jr      calc_wave_7

;--- Calc GM drums ---

calc_drm:       ld      a,d
	        cp      87
	        jr      nc,calc_drm3

calc_drm2:      ld      hl,gmdrm_b3
	        sub     35
	
	        add     a,a     ; A=A*4
	        add     a,a
	
	        add_hl_a
	        ld      a,(hl)
	        ld      (iy + 7),a
	        inc     hl
	        ld      a,(hl)
	        ld      (iy + 6),a
	        inc     hl
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)
	        ld      h,0
	        jr      calc_drmcnt2

calc_drm3:      ld      h,0     ; save some bytes later
	        cp      87
	        jr      z,calc_drm4
	        cp      88
	        jr      z,calc_drm5
	        ld      (iy + 7),59
	        ld      (iy + 6),1
	        jr      calc_drm_add1

calc_drm4:	ld      (iy + 7),201
calc_drm_add:   ld      (iy + 6),h      ;H=0
calc_drm_add1:  ld      de,256 * #f2 + #18
        	jr      calc_drmcnt2

calc_drm5:      ld      (iy + 7),198
        	jr      calc_drm_add

calc_own:       sub     176
	        ld      c,a
	        add     a,a
	        add     a,a
	        add     a,a
	        ld      l,a
	        ld      h,0
	        add     hl,hl
	        add_hl_a        ; * 24
	        ld      a,c
	        add_hl_a        ; * 25
	        ld      bc,waves
	        add     hl,bc   ; pointer to patch
	
	        ld      e,(hl)  ; transpose
	        inc     hl
	                        ; zoek juiste patch-deel
	        ld      a,d
	        srl     e       ;bit     0,e     ; transpose
	        jr      nc,calc_own2    ;jr      z,calc_own2
	        ld      a,(play_tspval)
	        add     a,d

calc_own2:      ld      d,0
        	ld      bc,3
calc_own_lp:    cp      (hl)
	        jr      c,calc_own_2
	        ld      d,(hl)
	        add     hl,bc
	        jr      calc_own_lp
calc_own_2:     ld      b,a     ; save note...
	        inc     hl
	        ld      a,(hl)  ; low byte tone
	        ld      e,a
	        add     a,128   ; tone 384 and above
	        ld      (iy + 7),a
	        ld      (iy + 6),1      ; RAM wave is altijd > 256
	        inc     hl

	        ld      a,(hl)  ; tone-note
	        add     a,b
	        sub     d
	        ld      (iy + 0),a      ; last note
	        push    af
	
	        ld      d,0     ; <-- D moet 0 zijn voor later
	        ld      (iy + 13),d     ; no header
	        ld      (iy + 14),d     ; can be done faster!
	
	        ld      hl,tones_data
	        add     hl,de
	        ld      a,(hl)
	        and     110b
	        ld      hl,frqtab_amiga
	        jr      z,calc_own3
	        ld      hl,frqtab_441khz
calc_own3:      pop     af
	        ld      (iy + 16),l
	        ld      (iy + 17),h
	
	        ld      e,a     ; D is still 0
	        add     hl,de
	        add     hl,de
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)
	        ld      h,0
	        jp      calc_drmcnt2

;---------------------------
;--- WAVE Event routines ---
;---------------------------

;--- Play ON-event ---

play_wonevt:    ld      d,a
	
	        ld      a,050h - 1
	        add     a,b     ; calc. register
	        out     (WVIO),a
	        ld      a,11111111b
	        ld      (iy + 2),0
	        out     (WVIO+1),a      ; volume 0!

;	        ld      a,068h - 1
;	        add     a,b     ; calc. register
;	        out     (WVIO),a
;	        xor     a

;	        out     (WVIO+1),a      ; off

	        ld      a,38h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,(iy + 9)
	        ld      (iy + 19),a
	        or      (iy + 12)
	        out     (WVIO+1),a      ; freq
        
	        ld      a,20h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,(iy + 8)
	        ld      (iy + 18),a
	        or      (iy + 6)
	        out     (WVIO+1),a      ; freq + tone
	
	        ld      a,8 - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,(iy + 7)
	        out     (WVIO+1),a      ; tone
	
	        ld      a,050h - 1 ; set volume back to normal
	        add     a,b
	        out     (WVIO),a
	        ld      a,(iy + 15)
	        or      1       ; level direct
	        out     (WVIO+1),a
	
	        ld      a,068h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,10000000b
	        or      (iy + 11)       ; pan pot
	        out     (WVIO+1),a      ; key on
	        jp      play_int_wend


;--- Play OFF event ---

play_woffevt:   ld      a,068h - 1
	        add     a,b     ; calc. register
	        out     (WVIO),a
	        ld      (iy+2),0        ; pb/mod off
	        in      a,(WVIO + 1)
	        and     1111111b
	        out     (WVIO + 1),a
	        jp      play_int_wend

play_woffevt1:  ld      a,068h - 1
	        add     a,b     ; calc. register
	        out     (WVIO),a
	        ld      (iy+2),0
	        in      a,(WVIO + 1)
	        and     1111111b
	        out     (WVIO + 1),a
	        ret

;--- Play Wave event ---

play_wwavevt:   sub     98 - 1
                call    play_wwavevt2
                jp      play_int_wend

play_wwavevt2:  ld      c,a
	        ld      hl,xwavnrs - 1
	        add_hl_a
	        ld      a,(hl)
	        ld      (iy + 10),a
	        ld      a,c
	        ld      hl,xwavvols - 1
	        add_hl_a
	        ld      a,(iy + 15)
	        and     1
	        ld      d,a
	        ld      a,(play_fading)
	        or      a
	        jr      nz,play_wavevtfd
	        ld      a,(hl)
	        add     a,a
	        add     a,a
	        or      d
	        ld      (iy + 15),a
	        ret

play_wavevtfd:  ld      a,(hl)
	        add     a,a
	        add     a,a
	        or      d
	        cp      (iy + 15)
	        ret     c
	        ld      (iy + 15),a
	        ret


;--- Play volume event ---

play_wchgvol:   sub     146
	        xor     31
	        add     a,a     ; *2 -> volume uses bit 7-1
	        call    play_wchgvol2
	        jp      play_int_wend
play_wchgvol2:  add     a,a     ; * 4, OPL4 can handle 0-127
	        add     a,a
	        ld      c,a
	
	        ld      a,(play_fading)
	        or      a
	        jr      z,play_wchgvolfd
	        ld      a,c
	        or      1
	        cp      (iy + 15)
	        ret     c
	        
play_wchgvolfd: ld      a,050h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,(iy + 15)     ; level direct
	        and     1
	        or      c
	        ld      (iy + 15),a
	        out     (WVIO+1),a
	        ret

;--- Link note ---

play_wlnk:	push    bc

	        ld      b,0                     ; Later voor snelheid
	        ld      (iy + 2),b      ;pb/mod off
	
	        sub     202
	        add     a,(iy + 0)
	        ld      (iy + 0),a
	
	        ld      c,a
	        bit     0,(iy + 6)
	        jr      z,play_wlnk2
	        bit     7,(iy + 7)
	        jr      nz,play_wlnk3

play_wlnk2:     ld      hl,tabdiv12
	        add     hl,bc
	        add     hl,bc
	        ld      c,(hl)
	        inc     hl
	        ld      a,(hl)
	        ld      l,(iy + 16)
	        ld      h,(iy + 17)
	        add_hl_a        ; ptr to freq
	
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)
	        ex      de,hl   ; HL = freq
	
	        sla     l
	        ld      a,h
	        rla
	        add     a,c
	        ld      h,a
play_wlnk_7:  	ld      d,b       ;ld d,0
	        ld      e,(iy + 5)
	        bit     7,e
	        jr      z,play_wlnk_6
	        dec     d
play_wlnk_6:    add     hl,de   ; detune...
	        add     hl,de
	
	        ld      (iy + 18),l     ; freq fine
	
	        pop     bc
	        ld      a,20h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,l
	        or      (iy + 6)
	        out     (WVIO+1),a      ; freq + tone
	
	        ld      a,38h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,h
	        ld      (iy + 19),a
	        or      (iy + 12)
	        out     (WVIO+1),a      ; freq
	        jp      play_int_wend

play_wlnk3:     ld      a,(iy + 7)
                cp      144
                jr      nc,play_wlnk2
	        ld      l,(iy + 16)     ; link own wave
	        ld      h,(iy + 17)
	
	        add     hl,bc   ; B is nog 0
	        add     hl,bc
	
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)
	        ex      de,hl   ; freq
	        jr      play_wlnk_7

;--- Play stereo event ---

play_wchgste:   sub     178 + 7
	        call    play_wchgste2
	        jp      play_int_wend
play_wchgste2:  and     1111b
	        ld      d,a
	        ld      a,(iy+11)
	        and     11110000b
	        or      d
	        ld      (iy+11),a
	        ld      a,68h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      (iy + 2),0
	        in      a,(WVIO + 1)
	        and     11110000b
	        or      d
	        out     (WVIO + 1),a
	        ret

;--- Pitch bending ---

play_wchgpit:	sub     221
	        ld      (iy+2),1        ; Pitch bending on
	        add     a,a
	        add     a,a
	        ld      (iy+3),a        ; Set pitch bend speed
	        rlca            ; bit 7,a
	        jr      c,play_wchgpit2
	        ld      (iy+4),0
	        jp      play_int_wend
play_wchgpit2:  ld      (iy+4),0ffh
        	jp      play_int_wend


;--- Modulation event ---

play_wchgmod:   sub     238 - 2
	        ld      (iy + 2),a
	        add     a,a
	        add     a,a
	        add     a,a
	        add     a,a
	        ld      hl,xmodtab - 2 * 16
	        add_hl_a
	        ld      (iy + 3),l
	        ld      (iy + 4),h
	        jp      play_int_wend

;--- Set detune ---

play_wchgdet:   sub     234
	        add     a,a
	        add     a,a     ; * 4
	        ld      (iy + 5),a
	        jp      play_int_wend


;--- Damp ---

play_chgdmp:    ld      a,068h - 1
	        add     a,b     ; calc. register
	        out     (WVIO),a
	        ld      (iy+2),0        ; pb/mod off
	        in      a,(WVIO+1)
	        or      1000000b
	        out     (WVIO + 1),a
	        jp      play_int_wend

play_chgdmp1:   ld      a,068h - 1
	        add     a,b     ; calc. register
	        out     (WVIO),a
	        ld      (iy+2),0
	        in      a,(WVIO+1)
	        or      1000000b
	        out     (WVIO + 1),a
	        ret

                IF      LFO
;--- LFO Switch ---
play_lfo:       ld      a,#67
                add     a,b
                out     (WVIO),a
                push	af
                pop	af
                in      a,(WVIO + 1)
                xor     #20
		push	af
		pop	af
                out     (WVIO + 1),a
                jp      play_int_wend

;--- LFO/Vibrato/Tremolo ---
play_chglvt:    ld      hl,table_lvt    ; tabel met LFO/Vibrato/Tremolo
                sub     246
                add     a,a
                add_hl_a
                ld      a,#67
                add     a,b
		ld	d,a	;save calculation for later
                out     (WVIO),a
                push	af
                pop	af
                in      a,(WVIO + 1)
                push    af
                or      #20		;reset LFO
                out     (WVIO + 1),a
                ld      a,#7f
                add     a,b
        	out     (WVIO),a	;store LFO+VIB settings
                ld      a,(hl)
                inc     hl
        	out     (WVIO + 1),a
                ld      a,#df
                add     a,b
                out     (WVIO),a
           	nop
		ld      a,(hl)
                out     (WVIO+1),a	;save tremolo depth
		ld	a,d
                nop   
		out     (#7e),a
		nop
                pop     af
                out     (#7f),a	;enable LFO
                jp      play_int_wend


; --- Tabel met LFO/Vibrato/Tremolo waarden
table_lvt:      defb    #31,0
                defb    #32,0
                defb    #33,0
                defb    #34,0
                defb    #35,0
                defb    #36,0
                defb    #37,0
                defb    #3a,5
                defb    #3,0
                ENDIF

;Pseudo-reverb off
play_revoff:    ld      (iy+12),0
                jp      play_int_wend

;--- Pseudo Reverb on
play_revon:     ld      (iy+12),8
                jp      play_int_wend

;--------------------------
;--- CMD Event routines ---
;--------------------------

;-- change tempo --

play_chgtmp:    ld      b,a
	        ld      a,25    ; Zelly, shut up!
	        sub     b
	        ld      (play_speed),a
	        jp      play_cmdcnt

;-- end of pattern --

play_endop:     ld      a,15
	        ld      (play_step),a
	        jp      play_cmdcnt

;--- set transpose ---

play_chgtrs:    sub     52
	        ld      (play_tspval),a
	        jp      play_cmdcnt



;---------------------------
;--- Go to next position ---
;---------------------------

play_nextpos:   ld      a,(songdata_bank1)
	        WRITE_FD	; this bank contains pattern addresses
	
	        ld      a,(xleng)
	        inc     a
	        ld      b,a
	        ld      a,(play_pos)
	        inc     a
	        cp      b
	        jr      c,play_nextpos2
	        ld      a,(xloop)

play_nextpos2:  ld      (play_pos),a
	        ld      hl,(pos_address)
	        add_hl_a
	        ld      a,(hl)
	        ld      (current_pat),a
	        add     a,a
	        ld      hl,(pat_address)
	        add_hl_a
	        ld      e,(hl)
	        inc     hl
	        ld      d,(hl)
	        ex      de,hl
	        ld      a,h
	        and     00111111b
	        ld      h,a
	        ld      de,(songdata_adres)
	        add     hl,de
	        inc     hl
	        inc     hl
	        inc     hl
	        ret

;--------------------------------
;--- Pitch interrupt routines ---
;--------------------------------

;----- pitch bending/modulation -----

play_pitch:     ld      iy,play_table_wav
	        ld      de,PTW_SIZE
	        ld      hl,play_pitchwvl2
play_pitch0:    ld      b,WAVCHNS               ; wave channels
play_pitchwlus: ld      a,(iy+2)
	        or      a
	        jr      nz,play_pitch_wdo
play_pitchwvl2: add     iy,de
	        djnz    play_pitchwlus
	        ret



;--- pitch bending ---

play_pitch_wdo:
	        push    bc
	        exx
	        pop     bc      ; channel number neccesary for calculating registers.
	
	        ld      c,a
	        ld      l,(iy + 3)      ; pitch bend speed
	        ld      h,(iy + 4)
	        dec     c
	        jr      nz,play_mod_wdo ; modulation
	        ex      de,hl
play_pitch_wd4: ld      h,(iy + 19)
	        ld      l,(iy + 18)
	        add     hl,de   ; sliding
	        bit     3,h
	        jr      z,play_pitch_wd5
	        bit     7,d
	        jr      nz,play_pitch_wd6
	        ld      a,h
	        add     a,1000b
	        ld      h,a
	        jr      play_pitch_wd5
play_pitch_wd6: res     3,h
play_pitch_wd5: ld      (iy + 18),l      ; freq fine
	        ld      (iy + 19),h
	
	        ld      a,#20 - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,l
	        or      (iy + 6)
	        out     (WVIO+1),a      ; freq + tone
	
	        ld      a,#38 - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,h
	        or      (iy + 12)
	        out     (WVIO+1),a      ; freq
	        exx
	        jp      (hl)


;---- modulation ----

play_mod_wdo:	ld      d,0
	        ld      e,(hl)
	        sla     e
	        sla     e
	        jr      nc,play_mod_wdo3
	        dec     d
play_mod_wdo3:  inc     hl
	        ld      a,(hl)
	        cp      10
	        jr      nz,play_mod_wdo2
	        ld      a,c
	
	        ld      hl,xmodtab - 16
	        add     a,a
	        add     a,a
	        add     a,a
	        add     a,a
	        add_hl_a
play_mod_wdo2:  ld      (iy + 3),l
	        ld      (iy + 4),h
	        jr      play_pitch_wd4


;-------------------------------
;--- Fade interrupt routines ---
;-------------------------------

		IF FADE
play_fade:      ld      a,(#ffe8)
                and     2
	        ld      b,2
	        or      a
	        jr      nz,play_fade1
	        ld      a,(play_fadetcnt)
	        cp      25
	        jr      z,play_fade3

play_fade1:     ld      a,2     ; speed (60 hz = 3, 50 hz = 2)
	        ld      hl,play_fadecnt
	        inc     (hl)
	        cp      (hl)
	        ret     nz
	        ld      (hl),0
	
play_fade0:     ld      b,WAVCHNS
	        ld      iy,play_table_wav
	        ld      de,PTW_SIZE
play_fadelp:    ld      a,(iy + 15)
	        add     a,8      ; -4, but bit 0 is not for volume
	        jr      nc,play_fade2
	        ld      a,255
play_fade2:     ld      (iy + 15),a
	        ld      a,050h - 1
	        add     a,b
	        out     (WVIO),a
	        ld      a,(iy + 15)     ; level direct
	        out     (WVIO+1),a
	        add     iy,de
	        djnz    play_fadelp

	        ld      hl,play_fadetcnt        ; total counter
	        inc     (hl)
	        ld      a,(hl)
	        cp      33      ; will always be faded out in 33 steps
	        ret     nz
play_fade3:     xor     a
	        ld      (play_fading),a
	        call    stop_music
	        di
	        ret
		ENDIF

;--- smart table: --

;    - last note played                 01: + 0
;    - frequency register               01: + 1
;    - pitch bending on/off             01: + 2
;    - pitch bend speed                 02: + 3
;    - detune value                     01: + 5
;    - tone nr for next interrupt       02: + 6
;    - freq for next interrupt          02: + 8
;    - current patch                    01  + 10
;    - current stereo setting           01  + 11
;    - pseudo reverb                    01  + 12
;    - Pointer to header bytes          02  + 13
;    - Volume                           01  + 15
;    - Pointer to used freq table       01  + 16
;    - Current pitch freq.              02  + 18
;                               --
;    Total:                             20

play_table_wav: defs    WAVCHNS * 20,0

;--- freq. table for 44.1 kHz

frqtab_441khz:  defw  (-4 * 2048 + 0) * 2
	        defw  (-4 * 2048 + 61) * 2
	        defw  (-4 * 2048 + 125) * 2
	        defw  (-4 * 2048 + 194) * 2
	        defw  (-4 * 2048 + 266) * 2
	        defw  (-4 * 2048 + 343) * 2
	        defw  (-4 * 2048 + 424) * 2
	        defw  (-4 * 2048 + 510) * 2
	        defw  (-4 * 2048 + 601) * 2
	        defw  (-4 * 2048 + 698) * 2
	        defw  (-4 * 2048 + 801) * 2
	        defw  (-4 * 2048 + 909) * 2
	        defw  (-3 * 2048 + 0) * 2
	        defw  (-3 * 2048 + 61) * 2
	        defw  (-3 * 2048 + 125) * 2
	        defw  (-3 * 2048 + 194) * 2
	        defw  (-3 * 2048 + 266) * 2
	        defw  (-3 * 2048 + 343) * 2
	        defw  (-3 * 2048 + 424) * 2
	        defw  (-3 * 2048 + 510) * 2
	        defw  (-3 * 2048 + 601) * 2
	        defw  (-3 * 2048 + 698) * 2
	        defw  (-3 * 2048 + 801) * 2
	        defw  (-3 * 2048 + 909) * 2
	        defw  (-2 * 2048 + 0) * 2
	        defw  (-2 * 2048 + 61) * 2
	        defw  (-2 * 2048 + 125) * 2
	        defw  (-2 * 2048 + 194) * 2
	        defw  (-2 * 2048 + 266) * 2
	        defw  (-2 * 2048 + 343) * 2
	        defw  (-2 * 2048 + 424) * 2
	        defw  (-2 * 2048 + 510) * 2
	        defw  (-2 * 2048 + 601) * 2
	        defw  (-2 * 2048 + 698) * 2
	        defw  (-2 * 2048 + 801) * 2
	        defw  (-2 * 2048 + 909) * 2
	        defw  (-1 * 2048 + 0) * 2
	        defw  (-1 * 2048 + 61) * 2
	        defw  (-1 * 2048 + 125) * 2
	        defw  (-1 * 2048 + 194) * 2
	        defw  (-1 * 2048 + 266) * 2
	        defw  (-1 * 2048 + 343) * 2
	        defw  (-1 * 2048 + 424) * 2
	        defw  (-1 * 2048 + 510) * 2
	        defw  (-1 * 2048 + 601) * 2
	        defw  (-1 * 2048 + 698) * 2
	        defw  (-1 * 2048 + 801) * 2
	        defw  (-1 * 2048 + 909) * 2
	        defw  (-0 * 2048 + 0) * 2
	        defw  (-0 * 2048 + 61) * 2
	        defw  (-0 * 2048 + 125) * 2
	        defw  (-0 * 2048 + 194) * 2
	        defw  (-0 * 2048 + 266) * 2
	        defw  (-0 * 2048 + 343) * 2
	        defw  (-0 * 2048 + 424) * 2
	        defw  (-0 * 2048 + 510) * 2
	        defw  (-0 * 2048 + 601) * 2
	        defw  (-0 * 2048 + 698) * 2
	        defw  (-0 * 2048 + 801) * 2
	        defw  (-0 * 2048 + 909) * 2
	        defw  (+1 * 2048 + 0) * 2
	        defw  (+1 * 2048 + 61) * 2
	        defw  (+1 * 2048 + 125) * 2
	        defw  (+1 * 2048 + 194) * 2
	        defw  (+1 * 2048 + 266) * 2
	        defw  (+1 * 2048 + 343) * 2
	        defw  (+1 * 2048 + 424) * 2
	        defw  (+1 * 2048 + 510) * 2
	        defw  (+1 * 2048 + 601) * 2
	        defw  (+1 * 2048 + 698) * 2
	        defw  (+1 * 2048 + 801) * 2
	        defw  (+1 * 2048 + 909) * 2
	        defw  (+2 * 2048 + 0) * 2
	        defw  (+2 * 2048 + 61) * 2
	        defw  (+2 * 2048 + 125) * 2
	        defw  (+2 * 2048 + 194) * 2
	        defw  (+2 * 2048 + 266) * 2
	        defw  (+2 * 2048 + 343) * 2
	        defw  (+2 * 2048 + 424) * 2
	        defw  (+2 * 2048 + 510) * 2
	        defw  (+2 * 2048 + 601) * 2
	        defw  (+2 * 2048 + 698) * 2
	        defw  (+2 * 2048 + 801) * 2
	        defw  (+2 * 2048 + 909) * 2
	        defw  (+3 * 2048 + 0) * 2
	        defw  (+3 * 2048 + 61) * 2
	        defw  (+3 * 2048 + 125) * 2
	        defw  (+3 * 2048 + 194) * 2
	        defw  (+3 * 2048 + 266) * 2
	        defw  (+3 * 2048 + 343) * 2
	        defw  (+3 * 2048 + 424) * 2
	        defw  (+3 * 2048 + 510) * 2
	        defw  (+3 * 2048 + 601) * 2
	        defw  (+3 * 2048 + 698) * 2
	        defw  (+3 * 2048 + 801) * 2
	        defw  (+3 * 2048 + 909) * 2

;--- freq table for Amiga ---

frqtab_amiga:	defw  (-5 * 2048 + 529) * 2	;C 1
	        defw  (-5 * 2048 + 621) * 2
	        defw  (-5 * 2048 + 721) * 2
	        defw  (-5 * 2048 + 823) * 2
	        defw  (-5 * 2048 + 937) * 2
	        defw  (-4 * 2048 + 14) * 2
	        defw  (-4 * 2048 + 76) * 2
	        defw  (-4 * 2048 + 142) * 2
	        defw  (-4 * 2048 + 211) * 2
	        defw  (-4 * 2048 + 284) * 2
	        defw  (-4 * 2048 + 361) * 2
	        defw  (-4 * 2048 + 447) * 2
	
	        defw  (-4 * 2048 + 529) * 2	;C 2
	        defw  (-4 * 2048 + 621) * 2
	        defw  (-4 * 2048 + 721) * 2
	        defw  (-4 * 2048 + 823) * 2
	        defw  (-4 * 2048 + 937) * 2
	        defw  (-3 * 2048 + 14) * 2
	        defw  (-3 * 2048 + 76) * 2
	        defw  (-3 * 2048 + 142) * 2
	        defw  (-3 * 2048 + 211) * 2
	        defw  (-3 * 2048 + 284) * 2
	        defw  (-3 * 2048 + 361) * 2
	        defw  (-3 * 2048 + 447) * 2
	
	        defw  (-3 * 2048 + 529) * 2 ;C 3
	        defw  (-3 * 2048 + 621) * 2
	        defw  (-3 * 2048 + 721) * 2
	        defw  (-3 * 2048 + 823) * 2
	        defw  (-3 * 2048 + 937) * 2
	        defw  (-2 * 2048 + 14) * 2
	        defw  (-2 * 2048 + 76) * 2
	        defw  (-2 * 2048 + 142) * 2
	        defw  (-2 * 2048 + 211) * 2
	        defw  (-2 * 2048 + 284) * 2
	        defw  (-2 * 2048 + 361) * 2
	        defw  (-2 * 2048 + 447) * 2
	
	        defw  (-2 * 2048 + 529) * 2	;C 4
	        defw  (-2 * 2048 + 621) * 2
	        defw  (-2 * 2048 + 721) * 2 ;D 4
	        defw  (-2 * 2048 + 823) * 2
	        defw  (-2 * 2048 + 937) * 2	;E 4
	        defw  (-1 * 2048 + 14) * 2	;F 4
	        defw  (-1 * 2048 + 76) * 2
	        defw  (-1 * 2048 + 142) * 2	;G 4
	        defw  (-1 * 2048 + 211) * 2
	        defw  (-1 * 2048 + 284) * 2	;A 4
	        defw  (-1 * 2048 + 361) * 2
	        defw  (-1 * 2048 + 447) * 2
	
	        defw  (-1 * 2048 + 529) * 2
	        defw  (-1 * 2048 + 621) * 2
	        defw  (-1 * 2048 + 721) * 2
	        defw  (-1 * 2048 + 823) * 2
	        defw  (-1 * 2048 + 937) * 2
	        defw  (-0 * 2048 + 14) * 2
	        defw  (-0 * 2048 + 76) * 2
	        defw  (-0 * 2048 + 142) * 2
	        defw  (-0 * 2048 + 211) * 2
	        defw  (-0 * 2048 + 284) * 2
	        defw  (-0 * 2048 + 361) * 2
	        defw  (-0 * 2048 + 447) * 2
	
	        defw  (-0 * 2048 + 529) * 2
	        defw  (-0 * 2048 + 621) * 2
	        defw  (-0 * 2048 + 721) * 2
	        defw  (-0 * 2048 + 823) * 2
	        defw  (-0 * 2048 + 937) * 2
	        defw  (+1 * 2048 + 14) * 2
	        defw  (+1 * 2048 + 76) * 2
	        defw  (+1 * 2048 + 142) * 2
	        defw  (+1 * 2048 + 211) * 2
	        defw  (+1 * 2048 + 284) * 2
	        defw  (+1 * 2048 + 361) * 2
	        defw  (+1 * 2048 + 447) * 2
	
	        defw  (+1 * 2048 + 529) * 2
	        defw  (+1 * 2048 + 621) * 2
	        defw  (+1 * 2048 + 721) * 2
	        defw  (+1 * 2048 + 823) * 2
	        defw  (+1 * 2048 + 937) * 2
	        defw  (+2 * 2048 + 14) * 2
	        defw  (+2 * 2048 + 76) * 2
	        defw  (+2 * 2048 + 142) * 2
	        defw  (+2 * 2048 + 211) * 2
	        defw  (+2 * 2048 + 284) * 2
	        defw  (+2 * 2048 + 361) * 2
	        defw  (+2 * 2048 + 447) * 2
	
	        defw  (+2 * 2048 + 529) * 2
	        defw  (+2 * 2048 + 621) * 2
	        defw  (+2 * 2048 + 721) * 2
	        defw  (+2 * 2048 + 823) * 2
	        defw  (+2 * 2048 + 937) * 2
	        defw  (+3 * 2048 + 14) * 2
	        defw  (+3 * 2048 + 76) * 2
	        defw  (+3 * 2048 + 142) * 2
	        defw  (+3 * 2048 + 211) * 2
	        defw  (+3 * 2048 + 284) * 2
	        defw  (+3 * 2048 + 361) * 2
	        defw  (+3 * 2048 + 447) * 2


songdata_bank:  defb    0
play_speed:     defb    0       ; current play speed
play_tspval:    defb    0       ; current transpose
play_timercnt:  defb    0       ; tempo counter
play_hzeql:     defb    0
current_pat:    defb    0
play_fadecnt:   defb    0
play_fadetcnt:  defb    0


xleng:          defs    1       ; Song length
xloop:          defs    1       ; Loop position
xwvstpr:        defs    24      ; Stereo settings Wave
xtempo:         defs    1       ; Tempo
xhzequal:       defs    1       ; 50/60 Hz Equalizer
xdetune:        defs    24      ; Detune settings
xmodtab:        defs    3*16    ; Modulation tables
xbegwav:        defs    24      ; Start waves
xwavnrs:        defs    48      ; Wave numbers
xwavvols:       defs    48      ; Wave volumes

pat_address:    defw    0
pos_address:    defw    0
songdata_ptr:   defw    0

waves:          defs	OWNWAVES * 25 ;48 * 25 was origineel
tones_data:     defs	256

; stel alle voices goed in
copy_waves:     ld      bc,2 * 256 + 17
                call    out_wave

                ld      hl,384 + OWNTONES + 1
                ld      (current_tone),hl

                ld      hl,xwavnrs      ; geselecteerde voices
                ld      ix,old_tones
                ld      bc,48 * 256 + 0 ; maximaal 48 voices/huidige voice num

copy_waves_lp:  ld      a,(current_tone)
                or	a
                ret     z       ; tone = 512 --> nokken
                ld      a,(hl)
                cp      175     ; GM Percussion of Own Waves?
                jr      nc,copy_waves_nt1        ; niet kopieren
                cp      173     ; Cymbal?
                jr      z,copy_waves_nt1
                push    bc
                push    hl
                call    already_copied
                or      a       ; <> 0 = al gehad
                jr      nz,copy_waves_nt        ; al gehad

                call    copy_ins        ; copier instrument

copy_waves_nt:  pop     hl
                pop     bc
copy_waves_nt1: inc     hl
                inc     c
                djnz    copy_waves_lp
                ret

; check of instrument al geweest is
already_copied: push    hl
                push    bc
                ld      de,xwavnrs

already_cop_lp: ld      a,c
                or      a
                jr      z,not_found       ; laatste gehad -> niet gevonden

                ld      a,(de)
                cp      (hl)
                jr      z,already_cop_e

                inc     de
                dec     c
                jr      already_cop_lp

already_cop_e:  ld      a,255   ; al gehad
not_found:      pop     bc
                pop     hl
                ret

; copier instrument
; In: HL: pointer naar instrumentenlijst
;     IX: pointer naar bewaarlijst
copy_ins:       ld      a,(hl)
                ld      (current_ins),a ; huidige instrument
                ld      hl,patch_table
                ld      e,a
                ld      d,0
                add     hl,de
                add     hl,de
                ld      e,(hl)
                inc     hl
                ld      d,(hl)  ; pointer naar instrument in patch_table

                ex      de,hl   ; HL = pointer in instrumenten data

                inc     hl
copy_ins_lp:    ld      a,(current_tone)
                or      a
                ret     z       ;tone = 512, kan niet verder vervangen
                push    hl
                inc     hl
                ld      e,(hl)
                inc     hl
                ld      d,(hl)
                ld      (ix),e
                ld      (ix + 1),d      ; bewaar oude toon

                ld      a,d
                or      1
                ld      (hl),a                  ;hi-byte
                dec     hl
                ld      a,(current_tone)        ;lowbyte
                ld      (hl),a  ; vervang tone

                inc     ix
                inc     ix

                call    copy_smp_hdr    ; copier sample-header uit ROM
                call    change_header   ; verander sample-header
                call    store_tone      ; copieer naar SRAM

                pop     hl
                ld      a,(hl)
                cp      255
                ret     z       ; 255 = laatste tone gehad
                ld      de,5
                add     hl,de   ; pointer naar volgende tone
                jr      copy_ins_lp     ; herhaal de zooi

; copier sample-header naar RAM
; In: DE: tone nummer
copy_smp_hdr:   ld      a,d
                and     1
                ld      d,a
                ld      bc,12
                call    muluw   ; HL = BC * DE

                ld      bc,3 * 256 + 0
                call    out_wave
                inc     b
                ld      c,h
                call    out_wave
                inc     b
                ld      c,l
                call    out_wave        ; zet SRAM adres

                ld      a,6
                out     (#7e),a

                ld      hl,sample_header ; bestemming
                ld      b,12
; copier header
copy_smp_hdrlp: in      a,(#c4)
                and     1
                jr      nz,copy_smp_hdrlp       ; wacht op OPL4
                in      a,(#7f)
                ld      (hl),a
                inc     hl
                djnz    copy_smp_hdrlp          ; herhalen
                ret

; verander sample-header
change_header:  ld      a,(current_ins)
                ld      hl,header_data          ;header_data
                ld      e,a
                ld      d,0
                add     hl,de
                add     hl,de
                ld      e,(hl)
                inc     hl
                ld      d,(hl)
                ex      de,hl   ; HL = pointer naar header data

                ld      de,sample_header + 7
                ld      a,(hl)
                ld      (de),a
                inc     hl
change_hdr_lp:  ld      a,(hl)
                cp      255
                ret     z       ; 255 = laatste gehad
                ld      de,sample_header + 8
                cp      #98
                jr      z,change_hdr_nt
                inc     de
                cp      #b0
                jr      z,change_hdr_nt
                inc     de
                cp      #c8
                jr      z,change_hdr_nt
                inc     de
change_hdr_nt:  inc     hl
                ld      a,(hl)
                ld      (de),a
                inc     hl
                jr      change_hdr_lp

; herstel tones weer
restore_tones:  ld      hl,384 + OWNTONES + 1
                ld      (current_tone),hl
                ld      hl,xwavnrs
                ld      ix,old_tones
                ld      bc,48 * 256 + 0    ; maximaal 48 voices/huidige voice

restore_tonelp: ld      a,(current_tone)
                or	a
                ret     z       ; tone = 512 --> nokken
                push    bc
                push    hl
                call    already_copied
                or      a       ; <> 0 = al gehad
                jr      nz,restore_tonent       ; al gehad

                call    select_old

restore_tonent: pop     hl
                pop     bc
                inc     hl
                inc     c
                djnz    restore_tonelp
                ret


store_tone:     ld      a,(current_tone)
                sub     128
                ld      e,a
                ld      d,0
                ld      bc,12
                call    muluw

                ld      bc,3 * 256 + #20
                call    out_wave
                inc     b
                ld      c,h
                call    out_wave
                inc     b
                ld      c,l
                call    out_wave

                ld      a,6
                out     (#7e),a
                ld      hl,sample_header
                ld      bc,24 * 256 + #7f       ;24, want OUTI verlaagt B
store_tone_lp:  in      a,(#c4)
                rra
                jr      c,store_tone_lp
                outi
                djnz    store_tone_lp

                ld      hl,(current_tone)
                inc     hl
                ld      (current_tone),hl
                ret

;zet de oude tones weer in de patch_table
select_old:     ld      a,(hl)
                cp      173
                ret     z
                cp      175
                ret     nc
                ld      hl,patch_table
                ld      e,a
                ld      d,0
                add     hl,de
                add     hl,de
                ld      e,(hl)
                inc     hl
                ld      d,(hl)
                ex      de,hl
                inc     hl

select_old_nt:  push    hl
                inc     hl
                ld      a,(ix)
                ld      (hl),a
                ld      a,(ix + 1)
                inc     hl
                ld      (hl),a
                inc     ix
                inc     ix
                pop     hl
                ld      a,(hl)
                cp      255
                ret     z       ; 255 = laatste tone gehad
                ld      de,5
                add     hl,de
                jp      select_old_nt

; vermenigvuldig BC met DE
; In: BC, DE
; Uit: HL: resultaat
; Verandert: AF, BC, DE, HL
muluw:          ld      hl,0

muluw_lp:       srl     d
                rr      e
                jr      nc,muluw_nt
                add     hl,bc
muluw_nt:       sla     c
                rl      b
                ld      a,d
                or      e
                ret     z
                jr      muluw_lp

; In: B: register
;     C: data
out_wave:       ld      a,b
                out     (#7e),a
                ld      a,c
         	nop
	        out     (#7f),a
                ret

sample_header:  defs    12
current_tone:   defw    384 + OWNTONES + 1      ; huidige tone om te vervangen
current_ins:    defb    0       ; huidige instrument
old_tones:      defs    256  ; vervangen tones

;patch table

patch_table:    defw      patch_0
	        defw      patch_1
	        defw      patch_2A, patch_2B
	        defw      patch_3A
	        defw      patch_3B
	        defw      patch_4
	        defw      patch_5A, patch_5B
	        defw      patch_6
	        defw      patch_7
	        defw      patch_8
	        defw      patch_9
	        defw      patch_10A, patch_10B
	        defw      patch_11
	        defw      patch_12
	        defw      patch_13
	        defw      patch_14
	        defw      patch_15A, patch_15B
	        defw      patch_16
	        defw      patch_17
	        defw      patch_18
	        defw      patch_19
	        defw      patch_20
	        defw      patch_21A, patch_21B
	        defw      patch_22
	        defw      patch_23A, patch_23B
	        defw      patch_24
	        defw      patch_25
	        defw      patch_26
	        defw      patch_27
	        defw      patch_28
	        defw      patch_29
	        defw      patch_30
	        defw      patch_31
	        defw      patch_32
	        defw      patch_33
	        defw      patch_34
	        defw      patch_35
	        defw      patch_36
	        defw      patch_37
	        defw      patch_38
	        defw      patch_39
	        defw      patch_40
	        defw      patch_41
	        defw      patch_42
	        defw      patch_43
	        defw      patch_44
	        defw      patch_45
	        defw      patch_46
	        defw      patch_47
	        defw      patch_48
	        defw      patch_49
	        defw      patch_50A, patch_50B
	        defw      patch_51A, patch_51B
	        defw      patch_52
	        defw      patch_53
	        defw      patch_54
	        defw      patch_55
	        defw      patch_56
	        defw      patch_57
	        defw      patch_58
	        defw      patch_59
	        defw      patch_60
	        defw      patch_61
	        defw      patch_62A, patch_62B
	        defw      patch_63A, patch_63B
	        defw      patch_64
	        defw      patch_65
	        defw      patch_66
	        defw      patch_67
	        defw      patch_68
	        defw      patch_69
	        defw      patch_70
	        defw      patch_71
	        defw      patch_72
	        defw      patch_73
	        defw      patch_74
	        defw      patch_75
	        defw      patch_76A,patch_76B
	        defw      patch_77A,patch_77B
	        defw      patch_78
	        defw      patch_80A, patch_80B
	        defw      patch_81A, patch_81B
	        defw      patch_82A, patch_82B
	        defw      patch_83A, patch_83B
	        defw      patch_84A, patch_84B
	        defw      patch_85A, patch_85B
	        defw      patch_86A, patch_86B
	        defw      patch_87A, patch_87B  ;patch_84B
	        defw      patch_88A, patch_88B
	        defw      patch_89A, patch_89B
	        defw      patch_90A, patch_90B
	        defw      patch_91A, patch_91B
	        defw      patch_92A, patch_92B
	        defw      patch_93A, patch_93B
	        defw      patch_94A, patch_94B
	        defw      patch_95A, patch_95B
	        defw      patch_79
	        defw      patch_96
	        defw      patch_97A, patch_97B
	        defw      patch_98A, patch_98B
	        defw      patch_99A, patch_99B
	        defw      patch_100A, patch_100B
	        defw      patch_102A, patch_102B
	        defw      patch_103A, patch_103B
	        defw      patch_104
	        defw      patch_105
	        defw      patch_106
	        defw      patch_107
	        defw      patch_109A,patch_109B
	        defw      patch_108
	        defw      patch_110
	        defw      patch_111
	        defw      patch_112A,patch_112B
	        defw      patch_113
	        defw      patch_114A,patch_114B
	        defw      patch_115
	        defw      patch_116
	        defw      patch_117
	        defw      patch_118
	        defw      patch_119
	        defw      patch_120
	        defw      patch_121
	        defw      patch_122A,patch_122B
	        defw      patch_124
	        defw      patch_125A,patch_125B
	        defw      patch_126A,patch_126B
	        defw      patch_127
	        defw      drum_1
	        defw      drum_2
	        defw      drum_3
	        defw      drum_4
	        defw      drum_5
	        defw      drum_6
	        defw      drum_7
	        defw      drum_8

;--- GM 0 = Ac. Piano ---

patch_0:        defb     1               ; transpose on
	        defb     16,02ch,1 + 36 * 2      ; tone 300
	        defw      frq_842
	        defb     22,02dh,1 + 52 * 2      ; tone 301
	        defw      frq_363
	        defb     28,02eh,1 + 46 * 2      ; tone 302
	        defw      frq_810
	        defb     34,02fh,1 + 52 * 2      ; tone 303
	        defw      frq_369
	        defb     40,030h,1 + 46 * 2      ; tone 304
	        defw      frq_726
	        defb     46,031h,1 + 52 * 2      ; tone 305
	        defw      frq_290
	        defb     52,032h,1 + 58 * 2      ; tone 306
	        defw      frq_21
	        defb     59,033h,1 + 52 * 2      ; tone 307
	        defw      frq_286
	        defb     65,034h,1 + 47 * 2      ; tone 308
	        defw      frq_941
	        defb     255,035h,1 + 65 * 2     ; tone 309
	        defw      frq_191

;--- GM 1 = Bright Acoustic Piano ---

patch_1:        defb     1               ; transpose on
	        defb     22,02ch,1 + 36 * 2      ; tone 300
	        defw      frq_842
	        defb     28,02dh,1 + 58 * 2      ; tone 301
	        defw      frq_363
	        defb     34,02eh,1 + 52 * 2      ; tone 302
	        defw      frq_809
	        defb     40,02fh,1 + 58 * 2      ; tone 303
	        defw      frq_369
	        defb     46,030h,1 + 52 * 2      ; tone 304
	        defw      frq_726
	        defb     52,031h,1 + 58 * 2      ; tone 305
	        defw      frq_290
	        defb     59,032h,1 + 64 * 2      ; tone 306
	        defw      frq_21
	        defb     65,033h,1 + 59 * 2      ; tone 307
	        defw      frq_286
	        defb     71,034h,1 + 53 * 2      ; tone 308
	        defw      frq_941
	        defb     255,035h,1 + 71 * 2      ; tone 309
	        defw      frq_191

;--- GM 2 = Elec. Grand Piano ---
; A = v104
; B = v98

patch_2A:       defb     1               ; transpose on
	        defb     22,02ch,1 + 36 * 2      ; tone 300
	        defw      frq_844
	        defb     28,02dh,1 + 58 * 2      ; tone 301
	        defw      frq_364
	        defb     34,02eh,1 + 52 * 2      ; tone 302
	        defw      frq_811
	        defb     40,02fh,1 + 58 * 2      ; tone 303
	        defw      frq_370
	        defb     46,030h,1 + 52 * 2      ; tone 304
	        defw      frq_727
	        defb     52,031h,1 + 58 * 2      ; tone 305
	        defw      frq_291
	        defb     59,032h,1 + 64 * 2      ; tone 306
	        defw      frq_22
	        defb     65,033h,1 + 59 * 2      ; tone 307
	        defw      frq_287
	        defb     71,034h,1 + 53 * 2      ; tone 308
	        defw      frq_942
	        defb     255,035h,1 + 71 * 2      ; tone 309
	        defw      frq_192

patch_2B:       defb     1               ; transpose on
	        defb     255,108,36 * 2
	        defw      frq_113

;--- GM 3 = Honky Tonk, met patch#0 ---
; gelijk volume

patch_3B:       defb     1               ; transpose on
	        defb     16,02ch,1 + 36 * 2      ; tone 300
	        defw      frq_852
	        defb     22,02dh,1 + 52 * 2      ; tone 301
	        defw      frq_355
	        defb     28,02eh,1 + 46 * 2      ; tone 302
	        defw      frq_820
	        defb     34,02fh,1 + 52 * 2      ; tone 303
	        defw      frq_360
	        defb     40,030h,1 + 46 * 2      ; tone 304
	        defw      frq_737
	        defb     46,031h,1 + 52 * 2      ; tone 305
	        defw      frq_282
	        defb     52,032h,1 + 58 * 2      ; tone 306
	        defw      frq_27
	        defb     59,033h,1 + 52 * 2      ; tone 307
	        defw      frq_282
	        defb     65,034h,1 + 47 * 2      ; tone 308
	        defw      frq_952
	        defb     255,035h,1 + 65 * 2      ; tone 309
	        defw      frq_184

; Honky Tonk A
patch_3A:       defb     1               ; transpose on
	        defb     16,02ch,1 + 36 * 2      ; tone 300
	        defw      frq_842
	        defb     22,02dh,1 + 52 * 2      ; tone 301
	        defw      frq_363
	        defb     28,02eh,1 + 46 * 2      ; tone 302
	        defw      frq_810
	        defb     34,02fh,1 + 52 * 2      ; tone 303
	        defw      frq_369
	        defb     40,030h,1 + 46 * 2      ; tone 304
	        defw      frq_726
	        defb     46,031h,1 + 52 * 2      ; tone 305
	        defw      frq_290
	        defb     52,032h,1 + 58 * 2      ; tone 306
	        defw      frq_21
	        defb     59,033h,1 + 52 * 2      ; tone 307
	        defw      frq_286
	        defb     65,034h,1 + 47 * 2      ; tone 308
	        defw      frq_941
	        defb     255,035h,1 + 65 * 2     ; tone 309
	        defw      frq_191

;--- GM 4 = Elec. Piano 1 (+ 2B?) ---
; Eigenlijk samen met tone 11, maar slaat nergens op

patch_4:        defb     1               ; transpose on
        defb     255,108,36 * 2
        defw      frq_113

;--- GM 5 = Elec. Piano 2 ---
; volumes gelijk

patch_5A:       defb     1               ; transpose on
        defb     16,02ch,1 + 36 * 2      ; tone 300
        defw      frq_844
        defb     22,02dh,1 + 52 * 2      ; tone 301
        defw      frq_364
        defb     28,02eh,1 + 46 * 2      ; tone 302
        defw      frq_811
        defb     34,02fh,1 + 52 * 2      ; tone 303
        defw      frq_370
        defb     40,030h,1 + 46 * 2      ; tone 304
        defw      frq_727
        defb     46,031h,1 + 52 * 2      ; tone 305
        defw      frq_291
        defb     52,032h,1 + 58 * 2      ; tone 306
        defw      frq_22
        defb     59,033h,1 + 52 * 2      ; tone 307
        defw      frq_287
        defb     65,034h,1 + 47 * 2      ; tone 308
        defw      frq_942
        defb     255,035h,1 + 65 * 2      ; tone 309
        defw      frq_192

patch_5B:       defb     1               ; transpose on
        defb     22,02ch,1 + 36 * 2      ; tone 300
        defw      frq_842
        defb     28,02dh,1 + 58 * 2      ; tone 301
        defw      frq_363
        defb     34,02eh,1 + 52 * 2      ; tone 302
        defw      frq_809
        defb     40,02fh,1 + 58 * 2      ; tone 303
        defw      frq_369
        defb     46,030h,1 + 52 * 2      ; tone 304
        defw      frq_726
        defb     52,031h,1 + 58 * 2      ; tone 305
        defw      frq_290
        defb     59,032h,1 + 64 * 2      ; tone 306
        defw      frq_21
        defb     65,033h,1 + 59 * 2      ; tone 307
        defw      frq_286
        defb     71,034h,1 + 53 * 2      ; tone 308
        defw      frq_941
        defb     255,035h,1 + 71 * 2      ; tone 309
        defw      frq_191


;--- GM 6 = Harpsichord ---

patch_6:        defb     1               ; transpose on
        defb     34,128,24 * 2
        defw      frq_288
        defb     40,129,46 * 2
        defw      frq_847
        defb     46,130,52 * 2
        defw      frq_288
        defb     54,131,46 * 2
        defw      frq_823
        defb     255,132,42 * 2
        defw      frq_823

;--- GM 7 = Clavi ---

patch_7:        defb     1               ; transpose on
        defb     58,39,24 * 2
        defw      frq_203
        defb     255,40,70 * 2           ; was andere header!
        defw      frq_215

;--- GM 8 = Celesta ---

patch_8:        defb     1               ; transpose on
        defb     255,43,12 * 2
        defw      frq_94

;--- GM 9 = Glockenspiel ---

patch_9:        defb      1               ; transpose on
        defb      255,243,0 * 2
        defw    frq_141

;--- GM 10 = Music Box ---

patch_10A:      defb      1               ; transpose on
        defb      255,243,12 * 2
        defw    frq_143

patch_10B:      defb      1               ; transpose on
        defb      255,1,1 + 24 * 2                 ; tone 257
        defw    frq_79


;--- GM 11 = Vibraphone ---

patch_11:       defb      1               ; transpose on
        defb      255,1,1 + 24 * 2                 ; tone 257
        defw    frq_82

;--- GM 12 = Marimba ---

patch_12:       defb      1               ; transpose on
        defb      40,244, 24 * 2
        defw    frq_82
        defb      255,245, 52 * 2         ; was andere header!
        defw    frq_69

;--- GM 13 = Xylophone ---

patch_13:       defb      1               ; transpose on
        defb      255,36h, 1 + 0 * 2       ; tone 310
        defw    frq_94

;--- GM 14 = Tubular Bells ---

patch_14:       defb      1               ; transpose on
        defb      255,255, 12 * 2
        defw    frq_532

;--- GM 15 = Dulcimer ---

patch_15A:      defb      1               ; transpose on
        defb      255,63, 12 * 2
        defw    frq_708
patch_15B:      defb      1
        defb      255,64, 12 * 2
        defw    frq_708

;--- GM 16 = Drawbar organ ---

patch_16:       defb      1               ; transpose on
        defb      255,142,12 * 2
        defw    frq_835

;--- GM 17 = Percussive organ ---

patch_17:       defb      1               ; transpose on
        defb      36,140, 24 * 2
        defw    frq_950
        defb      255,141, 36 * 2
        defw    frq_944

;--- GM 18 = Rock Organ ---

patch_18:       defb      1               ; transpose on
        defb      25,28h, 1 + 36 * 2      ; tone 296
        defw    frq_219
        defb      37,29h, 1 + 49 * 2      ; tone 297
        defw    frq_220
        defb      49,2ah, 1 + 49 * 2      ; tone 298
        defw    frq_217
        defb      61,2bh, 1 + 49 * 2      ; tone 299
        defw    frq_214
        defb      255,27h, 1 + 49 * 2      ; tone 295
        defw    frq_215

;--- GM 19 = Church organ ---

patch_19:       defb      1               ; transpose on
        defb      18,135, 36 * 2
        defw    frq_835
        defb      25,136, 54 * 2
        defw    frq_155
        defb      33,137, 49 * 2
        defw    frq_459
        defb      42,138, 45 * 2
        defw    frq_847
        defb      255,139, 54 * 2
        defw    frq_167

;--- GM 20 = Reed Organ ---

patch_20:       defb      1               ; transpose on
        defb      60,172, 24 * 2
        defw    frq_557
        defb      255,173, 60 * 2
        defw    frq_556

;--- GM 21 = Accordion ---

patch_21A:      defb      1               ; transpose on
        defb      53,6, 12 * 2
        defw    frq_727
        defb      255,7, 41 * 2
        defw    frq_1018

patch_21B:      defb      1               ; transpose on
        defb      255,112, 12 * 2
        defw    frq_833

;--- GM 22 = Harmonica ---

patch_22:       defb      1               ; transpose on
        defb      255,112, 12 * 2
        defw    frq_847

;--- GM 23 = Tango Accordion ---

patch_23A:      defb      1               ; transpose on
        defb      60,172, 24 * 2
        defw    frq_559
        defb      255,173, 60 * 2
        defw    frq_558
patch_23B:      defb      1
        defb      255,65, 48 * 2
        defw    frq_445

;--- GM 24 = Nylon Ac. Gtr ---

patch_24:       defb      1               ; transpose on
        defb      24,179, 36 * 2
        defw    frq_459
        defb      31,183, 48 * 2
        defw    frq_555
        defb      37,181, 55 * 2
        defw    frq_21
        defb      44,180, 49 * 2
        defw    frq_459
        defb      255,182, 44 * 2
        defw    frq_726

;--- GM 26 = Steel Ac. Gtr ---

patch_25:       defb      1               ; transpose on
        defb      26,12,36 * 2    ;was andere header
        defw    frq_442
        defb      33,13,50 * 2    ; "
        defw    frq_448
        defb      48,14,45 * 2    ; "
        defw    frq_823
        defb      255,15,48 * 2   ; "
        defw    frq_823

;--- GM 26 = Elec Jazz Gtr ---

patch_26:       defb      1               ; transpose on
        defb      26,90, 36 * 2
        defw    frq_373
        defb      40,91, 50 * 2
        defw    frq_143
        defb      255,92, 52 * 2
        defw    frq_70

;--- GM 27 = Elec Clean Gtr ---

patch_27:       defb      1               ; transpose on
        defb      21,97, 36 * 2
        defw    frq_519
        defb      26,96, 57 * 2
        defw    frq_143
        defb      33,99, 50 * 2
        defw    frq_701
        defb      40,98, 57 * 2
        defw    frq_9
        defb      45,101, 52 * 2
        defw    frq_508
        defb      52,100, 57 * 2
        defw    frq_118
        defb      61,102, 52 * 2
        defw    frq_531
        defb      255,103, 49 * 2
        defw    frq_823

;--- GM 28 = Muted Gtr ---

patch_28:       defb      1               ; transpose on
        defb      255,104, 12 * 2
        defw    frq_847

;--- GM 29 = Overdriven Gtr ---

patch_29:       defb      1               ; transpose on
        defb      41,165, 36 * 2
        defw    frq_228
        defb      255,166, 65 * 2
        defw    frq_459

;--- GM 30 = Distortion Gtr ---

patch_30:       defb      1               ; transpose on
        defb      19,81, 36 * 2
        defw    frq_434
        defb      23,82, 55 * 2
        defw    frq_143
        defb      27,83, 47 * 2
        defw    frq_847
        defb      31,84, 51 * 2
        defw    frq_434
        defb      35,85, 55 * 2
        defw    frq_143
        defb      39,86, 47 * 2
        defw    frq_847
        defb      43,87, 51 * 2
        defw    frq_459
        defb      47,88, 55 * 2
        defw    frq_143
        defb      255,89, 47 * 2
        defw    frq_775

;--- GM 31 = Gtr Harmonics ---

patch_31:       defb      1               ; transpose on
        defb      45,94, 24 * 2
        defw    frq_507
        defb      50,93, 69 * 2
        defw    frq_118
        defb      255,95, 62 * 2
        defw    frq_726

;--- GM 32 = Acoustic Bass ---

patch_32:       defb      1               ; transpose on
        defb      25,4, 48 * 2
        defw    frq_188
        defb      255,5, 49 * 2
        defw    frq_70

;--- GM 33 = Elec. Bass (finger) ---

patch_33:       defb      1               ; transpose on
        defb       9,74,48 * 2
        defw    frq_645
        defb      14,75,57 * 2
        defw    frq_221
        defb      19,76,50 * 2
        defw    frq_843
        defb      255,77,55 * 2
        defw    frq_378

;--- GM 34 = Elec. Bass (pick) ---

patch_34:       defb      1               ; transpose on
        defb      12,79,48 * 2
        defw    frq_135
        defb      19,80,48 * 2
        defw    frq_715
        defb      24,107,55 * 2
        defw    frq_264
        defb      48,105,48 * 2
        defw    frq_921
        defb      255,106,72 * 2
        defw    frq_434

;--- GM 35 = Fretless Bass ---

patch_35:       defb      1               ; transpose on
        defb      255,78,24 * 2
        defw    frq_373

;--- GM 36 = Slap Bass 1 ---

patch_36:       defb      1               ; transpose on
        defb      255,163,(36 + 3) * 2
        defw    frq_641

;--- GM 37 = Slap bass 2 ---

patch_37:       defb      1               ; transpose on
        defb      255,162,24 * 2
        defw    frq_288

;--- GM 38 = Synth Bass 1 ---

patch_38:       defb      1               ; transpose on
        defb      255,190,36 * 2
        defw    frq_835

;--- GM 39 = Synth Bass 2 ---

patch_39:       defb      1               ; transpose on
        defb      255,17h,1 + 48 * 2      ; tone 279
        defw    frq_215


;--- GM 40 = Violin ---

patch_40:       defb      1               ; transpose on
        defb      35,5h,1 + 24 * 2                ; tone 261
        defw    frq_288
        defb      40,2h,1 + 59 * 2                ; tone 258
        defw    frq_69
        defb      42,6h,1 + 52 * 2                ; tone 262
        defw    frq_627
        defb      45,7h,1 + 54 * 2                ; tone 263
        defw    frq_556
        defb      48,8h,1 + 57 * 2                ; tone 264
        defw    frq_264
        defb      51,0ah,1 + 48 * 2       ; tone 266
        defw    frq_920
        defb      53,0bh,1 + 51 * 2       ; tone 267
        defw    frq_726
        defb      55,0ch,1 + 53 * 2       ; tone 268
        defw    frq_579
        defb      58,0dh,1 + 55 * 2       ; tone 269
        defw    frq_338
        defb      255,09h,1 + 58  * 2      ; tone 265
        defw    frq_143


;--- GM 41 = Viola ---

patch_41:       defb      1               ; transpose on
        defb      27,03h,1 + 24 * 2       ; tone 259
        defw    frq_715
        defb      30,04h,1 + 51 * 2       ; tone 260
        defw    frq_531
        defb      33,05h,1 + 54 * 2       ; tone 261
        defw    frq_288
        defb      38,02h,1 + 57 * 2       ; tone 258
        defw    frq_69
        defb      40,06h,1 + 50 * 2       ; tone 262
        defw    frq_627
        defb      43,07h,1 + 52 * 2       ; tone 263
        defw    frq_556
        defb      46,08h,1 + 55 * 2       ; tone 264
        defw    frq_264
        defb      49,0ah,1 + 46 * 2       ; tone 266
        defw    frq_920
        defb      51,0bh,1 + 49 * 2       ; tone 267
        defw    frq_726
        defb      54,0ch,1 + 51 * 2       ; tone 268
        defw    frq_579
        defb      56,0dh,1 + 54 * 2       ; tone 269
        defw    frq_338
        defb      255,09h,1 + 56 * 2       ; tone 265
        defw    frq_143

;--- GM 42 = Cello ---

patch_42:       defb      1               ; transpose on
        defb      22,12h,1 + 36 * 2       ; tone 274
        defw    frq_203
        defb      32,13h,1 + 46 * 2       ; tone 275
        defw    frq_701
        defb      39,15h,1 + 44 * 2       ; tone 277
        defw    frq_822
        defb      45,16h,1 + 51 * 2       ; tone 278
        defw    frq_531
        defb      255,14h,1 + 57 * 2       ; tone 276
        defw    frq_69

;--- GM 43 = Contrabass ---

patch_43:       defb      1               ; transpose on
        defb      18,10h,1 + 48 * 2       ; tone 272
        defw    frq_15
        defb      255,11h,1 + 54 * 2       ; tone 273
        defw    frq_8

;--- GM 44 = Tremolo Strings ---

patch_44:       defb      1               ; transpose on
        defb      36,176,24 * 2
        defw    frq_98
        defb      42,53,48 * 2
        defw    frq_557
        defb      48,51,54 * 2
        defw    frq_26
        defb      59,52,48 * 2
        defw    frq_650
        defb      255,175,47 * 2
        defw    frq_538

;--- GM 45 = Pizzicato Strings ---

patch_45:       defb      1               ; transpose on
        defb      27,184,36 * 2
        defw    frq_20
        defb      36,185,51 * 2
        defw    frq_216
        defb      43,187,48 * 2
        defw    frq_639
        defb      49,186,55 * 2
        defw    frq_84
        defb      255,188,49 * 2
        defw    frq_455

;--- GM 46 = Harp ---

patch_46:       defb      1               ; transpose on
        defb      47,126,12 * 2
        defw    frq_360
        defb      255,127,47 * 2
        defw    frq_434

;--- GM 47 = Timpani ---

patch_47:       defb      1               ; transpose on
        defb      255,0,1 + 36 * 2                 ; tone 256
        defw    frq_217


;--- GM 48 = Strings ---

patch_48:       defb      1               ; transpose on
        defb      36,03ch,1 + 24 * 2      ; tone 316
        defw    frq_96
        defb      42,03eh,1 + 48 * 2        ; tone 318
        defw    frq_557
        defb      48,03dh,1 + 54 * 2        ; tone 317
        defw    frq_24
        defb      59,03fh,1 + 48 * 2        ; tone 319
        defw    frq_653
        defb      255,040h,1 + 47 * 2     ; tone 320
        defw    frq_548

;--- GM 49 = Slow Strings ---

patch_49:       defb      1               ; transpose on
        defb      36,176, 24 * 2
        defw    frq_98
        defb      42,53, 48 * 2
        defw    frq_557
        defb      48,51, 54 * 2
        defw    frq_27
        defb      59,52, 48 * 2
        defw    frq_650
        defb      255,175, 47 * 2
        defw    frq_538

;--- GM 50 = Synth Strings 1 ---

patch_50A:      defb      1               ; transpose on
        defb      255,2, 24 * 2
        defw    frq_935
patch_50B:      defb      1               ; transpose on
        defb      255,174, 12 * 2
        defw    frq_91

;--- GM 51 = Synth Strings 2 ---

patch_51A:      defb      1               ; transpose on
        defb      255,2, 12 * 2
        defw    frq_935
patch_51B:      defb      1               ; transpose on
        defb      255,2, 12 * 2
        defw    frq_927


;--- GM 52 = Choir Aahs ---

patch_52:       defb      1               ; transpose on
        defb      35,24, 24 * 2
        defw    frq_204
        defb      41,25, 47 * 2
        defw    frq_815
        defb      48,26, 53 * 2
        defw    frq_206
        defb      255,27, 48 * 2
        defw    frq_356

;--- GM 53 = Voice Oohs ---

patch_53:       defb      1               ; transpose on
        defb      255,41, 12 * 2
        defw    frq_273

;--- GM 54 = Synth Voice ---

patch_54:       defb      1               ; transpose on
        defb      255,42, 12 * 2
        defw    frq_208

;--- GM 55 = Orchestra Hit ---

patch_55:       defb      1               ; transpose on
        defb      255,73, 12 * 2
        defw    frq_835

;--- GM 56 = Trumpet ---

patch_56:       defb      1               ; transpose on
        defb      37,246, 24 * 2
        defw    frq_46
        defb      44,248, 49 * 2
        defw    frq_460
        defb      49,247, 56 * 2
        defw    frq_22
        defb      55,250, 49 * 2
        defw    frq_436
        defb      62,249, 55 * 2
        defw    frq_46
        defb      255,251, 50 * 2
        defw    frq_436

;--- GM 57 = Trombone ---

patch_57:       defb      1               ; transpose on
        defb      35,240, 24 * 2
        defw    frq_228
        defb      40,241, 47 * 2
        defw    frq_750
        defb      255,242, 52 * 2
        defw    frq_264

;--- GM 58 = Tuba ---

patch_58:       defb      1               ; transpose on
        defb      22,133, 36 * 2
        defw    frq_550
        defb      255,134, 46 * 2
        defw    frq_908

;--- GM 59 = Muted Trumpet ---

patch_59:       defb      1               ; transpose on
        defb      46,177, 12 * 2
        defw    frq_630
        defb      255,178, 46 * 2
        defw    frq_630

;--- GM 60 = French Horn ---

patch_60:       defb      1               ; transpose on
        defb      50,124, 12 * 2
        defw    frq_290
        defb      255,125, 50 * 2
        defw    frq_679

;--- GM 61 = Brass Section ---

patch_61:       defb      1               ; transpose on
        defb      43,252, 12 * 2
        defw    frq_820
        defb      255,253, 43 * 2
        defw    frq_832

;--- GM 62 = Synth Brass 1 ---

patch_62A:      defb      1               ; transpose on
        defb      16,211, 48 * 2
        defw    frq_916
        defb      22,218, 64 * 2
        defw    frq_354
        defb      28,212, 58 * 2
        defw    frq_916
        defb      34,219, 64 * 2
        defw    frq_345
        defb      40,213, 58 * 2
        defw    frq_935
        defb      46,220, 64 * 2
        defw    frq_350
        defb      52,214, 58 * 2
        defw    frq_925
        defb      58,221, 64 * 2
        defw    frq_363
        defb      64,215, 58 * 2
        defw    frq_969
        defb      70,222, 64 * 2
        defw    frq_338
        defb      77,216, 58 * 2
        defw    frq_925
        defb      255,217, 53 * 2
        defw    frq_925

patch_62B:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_929
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_360
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_927
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_360
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_939
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_366
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_951
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_366
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_977
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_342
        defb      77,22h, 1 + 58 * 2      ; tone 290
        defw    frq_927
        defb      255,23h, 1 + 53 * 2      ; tone 291
        defw    frq_927

;--- GM 63 = Synth Brass 2 ---
; B zachter dan A, vals??

patch_63A:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_931
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_361
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_929
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_361
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_941
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_367
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_953
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_367
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_978
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_343
        defb      77,22h, 1 + 58 * 2      ; tone 290
        defw    frq_929
        defb      255,23h, 1 + 53 * 2      ; tone 291
        defw    frq_929

patch_63B:      defb      1               ; transpose on
        defb      255,24h, 1 + 12 * 2      ; tone 292
        defw    frq_557

;--- GM 64 = Soprano Sax ---

patch_64:       defb      1               ; transpose on
        defb      40,227, 12 * 2
        defw    frq_701
        defb      46,228, 52 * 2
        defw    frq_216
        defb      52,229, 46 * 2
        defw    frq_677
        defb      58,230, 52 * 2
        defw    frq_242
        defb      65,231, 46 * 2
        defw    frq_726
        defb      255,232, 65 * 2
        defw    frq_94

;--- GM 65 = Alto Sax ---

patch_65:       defb      1               ; transpose on
        defb      27,146, 36 * 2
        defw    frq_27
        defb      30,150, 51 * 2
        defw    frq_737
        defb      35,153, 54 * 2
        defw    frq_385
        defb      36,143, 59 * 2
        defw    frq_242
        defb      39,147, 60 * 2
        defw    frq_46
        defb      42,151, 51 * 2
        defw    frq_775
        defb      45,154, 54 * 2
        defw    frq_460
        defb      48,144, 57 * 2
        defw    frq_216
        defb      51,148, 60 * 2
        defw    frq_22
        defb      53,152, 51 * 2
        defw    frq_727
        defb      57,155, 53 * 2
        defw    frq_480
        defb      60,145, 57 * 2
        defw    frq_290
        defb      255,149, 60 * 2
        defw    frq_94

;--- GM 66 = Tenor Sax ---

patch_66:       defb      1               ; transpose on
        defb      25,233, 36 * 2
        defw    frq_75
        defb      29,234, 49 * 2
        defw    frq_715
        defb      35,235, 53 * 2
        defw    frq_228
        defb      42,237, 47 * 2
        defw    frq_653
        defb      48,236, 54 * 2
        defw    frq_70
        defb      58,238, 48 * 2
        defw    frq_531
        defb      255,239, 46 * 2
        defw    frq_920

;--- GM 67 = Baritone Sax ---

patch_67:       defb      1               ; transpose on
        defb      22,223, 36 * 2
        defw    frq_299
        defb      29,225, 46 * 2
        defw    frq_545
        defb      34,226, 53 * 2
        defw    frq_299
        defb      255,224, 46 * 2
        defw    frq_874

;--- GM 68 = Oboe ---

patch_68:       defb      1               ; transpose on
        defb      37,66, 12 * 2
        defw    frq_920
        defb      44,68, 49 * 2
        defw    frq_338
        defb      50,67, 44 * 2
        defw    frq_920
        defb      56,70, 50 * 2
        defw    frq_335
        defb      62,69, 44 * 2
        defw    frq_920
        defb      255,71, 50 * 2
        defw    frq_335

;--- GM 69 = English Horn ---

patch_69:       defb      1               ; transpose on
        defb      33,60, 24 * 2
        defw    frq_254
        defb      39,59, 45 * 2
        defw    frq_750
        defb      255,61, 51 * 2
        defw    frq_242

;--- GM 70 = Bassoon ---

patch_70:       defb      1               ; transpose on
        defb      11,56, 48 * 2
        defw    frq_73
        defb      23,58, 47 * 2
        defw    frq_532
        defb      255,57, 59 * 2
        defw    frq_75

;--- GM 71 = Clarinet ---

patch_71:       defb      1               ; transpose on
        defb      36,158, 24 * 2
        defw    frq_810
        defb      42,160, 60 * 2
        defw    frq_288
        defb      51,159, 54 * 2
        defw    frq_726
        defb      255,161, 51 * 2
        defw    frq_920

;--- GM 72 = Piccolo ---

patch_72:       defb      1               ; transpose on
        defb      41,113, 24 * 2
        defw    frq_94
        defb      54,114, 53 * 2
        defw    frq_118
        defb      60,115, 54 * 2
        defw    frq_94
        defb      72,116, 60 * 2
        defw    frq_288
        defb      255,117, 60 * 2
        defw    frq_920

;--- GM 73 = Flute ---

patch_73:       defb      1               ; transpose on
        defb      41,113, 24 * 2
        defw    frq_94
        defb      54,114, 53 * 2
        defw    frq_118
        defb      255,115, 54 * 2
        defw    frq_94

;--- GM 74 = Recorder ---

patch_74:       defb      1               ; transpose on
        defb      255,189, 24 * 2
        defw    frq_143

;--- GM 75 = Pan Flute ---

patch_75:       defb      1               ; transpose on
        defb      255,119, 0 * 2
        defw    frq_461

;--- GM 76 = Blown Bottle ---

patch_76A:      defb      1               ; transpose on
        defb      255,119, 0 * 2
        defw    frq_461
patch_76B:      defb      1               ; transpose on
        defb      255,25h, 1 + (12 + 2) * 2         ; tone 293
        defw    frq_21

;--- GM 77 = Shakuhachi ---

patch_77A:      defb      1               ; transpose on
        defb      255,171, 12 * 2
        defw    frq_969
patch_77B:      defb      1               ; transpose on
        defb      255,118, 12 * 2
        defw    frq_345

;--- GM 78 = Whistle ---

patch_78:       defb      1               ; transpose on
        defb      255,170, 0 * 2
        defw    frq_94

;--- GM 79 = Ocarina ---

patch_79:       defb      1               ; transpose on
        defb      255,170, 0 * 2
        defw    frq_94

;--- GM 80 = Lead 1 (square) ---

patch_80A:      defb      1               ; transpose on
        defb      19,204, 60 * 2
        defw    frq_341
        defb      31,205, 55 * 2
        defw    frq_343
        defb      43,202, 55 * 2
        defw    frq_343
        defb      55,207, 55 * 2
        defw    frq_343
        defb      67,206, 55 * 2
        defw    frq_343
        defb      255,203, 55 * 2
        defw    frq_343

patch_80B:      defb      1               ; transpose on
        defb      19,204, 60 * 2
        defw    frq_335
        defb      31,205, 55 * 2
        defw    frq_338
        defb      43,202, 55 * 2
        defw    frq_338
        defb      55,207, 55 * 2
        defw    frq_338
        defb      67,206, 55 * 2
        defw    frq_338
        defb      255,203, 55 * 2
        defw    frq_338

;--- GM 81 = Lead 2 (sawtooth) ---

patch_81A:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_927
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_358
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_925
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_358
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_936
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_364
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_949
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_364
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_974
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_340
        defb      79,22h, 1 + 58 * 2      ; tone 290
        defw    frq_925
        defb      255,23h, 1 + 55 * 2      ; tone 291
        defw    frq_925

patch_81B:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_918
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_352
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_916
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_352
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_927
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_358
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_941
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_358
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_966
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_333
        defb      79,22h, 1 + 58 * 2      ; tone 290
        defw    frq_916
        defb      255,23h, 1 + 55 * 2      ; tone 291
        defw    frq_916

;--- GM 82 = Lead 3 (calliope) ---

patch_82A:      defb      1               ; transpose on
        defb      255,170, 0 * 2
        defw    frq_94
patch_82B:      defb      1               ; transpose on
        defb      255,118, 12 * 2
        defw    frq_345

;--- GM 83 = Lead 4 (chiff) ---

patch_83A:      defb      1               ; transpose on
        defb      255,3ah, 1 + 12 * 2      ; tone 314
        defw    frq_314
patch_83B:      defb      1               ; transpose on
        defb      255,254, 12 * 2
        defw    frq_311

;--- GM 84 = Lead 5 (charang) ---

patch_84A:      defb      1               ; transpose on
        defb      41,165, 36 * 2
        defw    frq_231
        defb      255,166, 65 * 2
        defw    frq_462

patch_84B:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_918
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_352
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_916
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_352
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_927
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_358
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_941
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_358
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_966
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_333
        defb      79,22h, 1 + 58 * 2      ; tone 290
        defw    frq_916
        defb      255,23h, 1 + 55 * 2      ; tone 291
        defw    frq_916

;--- GM 85 = Lead 6 (voice) ---

patch_85A:      defb      1               ; transpose on
        defb      255,170, 0 * 2
        defw    frq_98

patch_85B:      defb      1               ; transpose on
        defb      255,42, 12 * 2
        defw    frq_204

;--- GM 86 = Lead 7 (fifths) ---

patch_86A:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_918
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_352
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_916
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_352
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_927
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_358
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_941
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_358
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_966
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_333
        defb      79,22h, 1 + 58 * 2      ; tone 290
        defw    frq_916
        defb      255,23h, 1 + 55 * 2      ; tone 291
        defw    frq_916

patch_86B:      defb      1               ; transpose on
        defb      255,2, 12 * 2
        defw    frq_929

;--- GM 87 = Lead 8 (bass + lead) ---

patch_87A:      defb      1               ; transpose on
        defb      255,17h, 1 + 48 * 2      ; tone 279
        defw    frq_219

patch_87B:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_918
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_352
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_916
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_352
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_927
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_358
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_941
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_358
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_966
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_333
        defb      79,22h, 1 + 58 * 2      ; tone 290
        defw    frq_916
        defb      255,23h, 1 + 55 * 2      ; tone 291
        defw    frq_916

;--- GM 88 = Pad 1 (new age) ---
; B zachter dan A
patch_88A:      defb      1               ; transpose on
        defb      255,2, 12 * 2
        defw    frq_927

patch_88B:      defb      1               ; transpose on
        defb      255,243, 12 * 2
        defw    frq_721

;--- GM 89 = Pad 2 (warm) ---
; B zachter dan A
patch_89A:      defb      1               ; transpose on
        defb      255,78, 24 * 2
        defw    frq_379

patch_89B:      defb      1               ; transpose on
        defb      255,41, 12 * 2
        defw    frq_261

;--- GM 90 = Pad 3 (polysynth) ---

patch_90A:      defb      1               ; transpose on
        defb      16,18h, 1 + 48 * 2      ; tone 280
        defw    frq_929
        defb      22,19h, 1 + 64 * 2      ; tone 281
        defw    frq_360
        defb      28,1ah, 1 + 58 * 2      ; tone 282
        defw    frq_927
        defb      34,1bh, 1 + 64 * 2      ; tone 283
        defw    frq_360
        defb      40,1ch, 1 + 58 * 2      ; tone 284
        defw    frq_939
        defb      46,1dh, 1 + 64 * 2      ; tone 285
        defw    frq_366
        defb      52,1eh, 1 + 58 * 2      ; tone 286
        defw    frq_951
        defb      58,1fh, 1 + 64 * 2      ; tone 287
        defw    frq_366
        defb      64,20h, 1 + 58 * 2      ; tone 288
        defw    frq_977
        defb      70,21h, 1 + 64 * 2      ; tone 289
        defw    frq_341
        defb      79,22h, 1 + 58 * 2      ; tone 290
        defw    frq_927
        defb      255,23h, 1 + 55 * 2      ; tone 291
        defw    frq_927

patch_90B:      defb      1               ; transpose on
        defb      255,24h, 1 + 12 * 2      ; tone 292
        defw    frq_550

;--- GM 91 = Pad 4 (choir) ---

patch_91A:      defb      1               ; transpose on
        defb      35,24, 24 * 2
        defw    frq_204
        defb      41,25, 47 * 2
        defw    frq_815
        defb      48,26, 53 * 2
        defw    frq_206
        defb      255,27, 48 * 2
        defw    frq_356

patch_91B:      defb      1               ; transpose on
        defb      255,42, 12 * 2
        defw    frq_208

;--- GM 92 = Pad 5 (bowed) ---

patch_92A:      defb      1               ; transpose on
        defb      255,2, 1 + 24 * 2        ; tone 257
        defw    frq_88
patch_92B:      defb      1               ; transpose on
        defb      255,170, 0 * 2
        defw    frq_89

;--- GM 93 = Pad 6 (metallic) ---

patch_93A:      defb      1               ; transpose on
        defb      26,12, 36 * 2
        defw    frq_445
        defb      33,13, 50 * 2
        defw    frq_450
        defb      48,14, 45 * 2
        defw    frq_828
        defb      255,15, 48 * 2
        defw    frq_828

patch_93B:      defb      1               ; transpose on
        defb      255,63, 12 * 2
        defw    frq_698

;--- GM 94 = Pad 7 (halo) ---
patch_94A:      defb      1               ; transpose on
        defb      255,24h, 1 + 12 * 2     ; 292
        defw    frq_560

patch_94B:      defb      1               ; transpose on
        defb      255,42, 12 * 2
        defw    frq_202

;--- GM 95 = Pad 8 (sweep) ---

patch_95A:      defb      1               ; transpose on
        defb      16,211, 48 * 2
        defw    frq_920
        defb      22,218, 64 * 2
        defw    frq_356
        defb      28,212, 58 * 2
        defw    frq_920
        defb      34,219, 64 * 2
        defw    frq_348
        defb      40,213, 58 * 2
        defw    frq_937
        defb      46,220, 64 * 2
        defw    frq_352
        defb      52,214, 58 * 2
        defw    frq_926
        defb      58,221, 64 * 2
        defw    frq_365
        defb      64,215, 58 * 2
        defw    frq_974         ; 975
        defb      70,222, 64 * 2
        defw    frq_341
        defb      76,216, 58 * 2
        defw    frq_926
        defb      255,217, 52 * 2
        defw    frq_926

patch_95B:      defb      1               ; transpose on
        defb      16,211, 48 * 2
        defw    frq_909
        defb      22,218, 64 * 2
        defw    frq_350
        defb      28,212, 58 * 2
        defw    frq_909
        defb      34,219, 64 * 2
        defw    frq_340
        defb      40,213, 58 * 2
        defw    frq_927
        defb      46,220, 64 * 2
        defw    frq_345
        defb      52,214, 58 * 2
        defw    frq_916
        defb      58,221, 64 * 2
        defw    frq_357
        defb      64,215, 58 * 2
        defw    frq_964
        defb      70,222, 64 * 2
        defw    frq_333
        defb      76,216, 58 * 2
        defw    frq_926
        defb      255,217, 52 * 2
        defw    frq_916

;--- GM 96 = Rain ---

patch_96:       defb      0               ; transpose off
        defb      255,43h, 1 + (48 + 1) * 2        ; tone 323
        defw    frq_448

;--- GM 97 = Soundtrack ---

patch_97A:      defb      1               ; transpose on
        defb      255,2, 24 * 2
        defw    frq_927

patch_97B:      defb      1               ; transpose on
        defb      255,243, 0 * 2
        defw    frq_704

;--- GM 98 = Crystal ---

patch_98A:      defb      1               ; transpose on
        defb      255,243, 0 * 2
        defw    frq_143
patch_98B:      defb      1               ; transpose on
        defb      21,109, 36 * 2
        defw    frq_824
        defb      31,110, 45 * 2
        defw    frq_831
        defb      255,111, 43 * 2
        defw    frq_843

;--- GM 99 = Atmosphere ---

patch_99A:      defb      1               ; transpose on
        defb      255,2, 24 * 2
        defw    frq_927

patch_99B:      defb      1               ; transpose on
        defb      24,179, 36 * 2
        defw    frq_459
        defb      31,183, 48 * 2
        defw    frq_555
        defb      37,181, 55 * 2
        defw    frq_21
        defb      44,180, 49 * 2
        defw    frq_459
        defb      255,182, 44 * 2
        defw    frq_726

;--- GM 100 = Brightness ---

patch_100A:     defb      1               ; transpose on
        defb      255,37h, 1 + 24 * 2      ; tone 311
        defw    frq_366
patch_100B:     defb      1               ; transpose on
        defb      255,42, 12 * 2
        defw    frq_208

;--- GM 102 = Echoes ---

patch_102A:     defb      1               ; transpose on
        defb      255,24h, 1 + 24 * 2      ; tone 292
        defw    frq_552
patch_102B:     defb      1               ; transpose on
        defb      255,42, 12 * 2
        defw    frq_211

;--- GM 103 = FX 8 (sci-fi) ---

patch_103A:     defb      1               ; transpose on
        defb      26,12, 36 * 2
        defw    frq_443
        defb      33,13, 50 * 2
        defw    frq_448
        defb      48,14, 45 * 2
        defw    frq_824
        defb      255,15, 48 * 2
        defw    frq_824

patch_103B:     defb      1               ; transpose on
        defb      255,2, 12 * 2
        defw    frq_925

;--- GM 104 = Sitar ---

patch_104:      defb      1               ; transpose on
        defb      255,0fh, 1 + 12 * 2      ; tone 271
        defw    frq_847

;--- GM 105 = Banjo ---

patch_105:      defb      1               ; transpose on
        defb      29,19, 24 * 2
        defw    frq_641
        defb      33,20, 53 * 2
        defw    frq_203
        defb      37,18, 45 * 2
        defw    frq_944
        defb      45,21, 49 * 2
        defw    frq_288
        defb      53,23, 45 * 2
        defw    frq_677
        defb      255,22, 53 * 2
        defw    frq_45

;--- GM 106 = Shamisen ---

patch_106:      defb      1               ; transpose on
        defb      255,0eh, 1 + 12 * 2      ; tone 270
        defw    frq_97

;--- GM 107 = Koto ---

patch_107:      defb      1               ; transpose on
        defb      255,169, 12 * 2
        defw    frq_556

;--- GM 108 = Kalimba ---

patch_108:      defb      1               ; transpose on
        defb      255,37h, 1 + 12 * 2      ; tone 311
        defw    frq_366

;--- GM 109 = Bagpipes ---

patch_109A:     defb      1               ; transpose on
        defb      34,164, 48 * 2
        defw    frq_1
        defb      255,168, 46 * 2
        defw    frq_335

patch_109B:     defb      1               ; transpose on
        defb      34,167, 48 * 2
        defw    frq_0
        defb      255,168, 46 * 2
        defw    frq_335

;--- GM 110 = Fiddle ---

patch_110:      defb      1               ; transpose on
        defb      35,05h, 1 + 24 * 2      ; tone 261
        defw    frq_288
        defb      40,02h, 1 + 59 * 2      ; tone 258
        defw    frq_69
        defb      42,06h, 1 + 52 * 2      ; tone 262
        defw    frq_630
        defb      45,07h, 1 + 54 * 2      ; tone 263
        defw    frq_556
        defb      48,08h, 1 + 57 * 2      ; tone 264
        defw    frq_264
        defb      51,0ah, 1 + 48 * 2      ; tone 266
        defw    frq_920
        defb      53,0bh, 1 + 51 * 2      ; tone 267
        defw    frq_726
        defb      55,0ch, 1 + 53 * 2      ; tone 268
        defw    frq_579
        defb      58,0dh, 1 + 55 * 2      ; tone 269
        defw    frq_338
        defb      255,09h, 1 + 58 * 2      ; tone 265
        defw    frq_143

;--- GM 111 = Shanai ---

patch_111:      defb      1               ; transpose on
        defb      255,65, 36 * 2
        defw    frq_448

;--- GM 112 = Tinkle Bell ---

patch_112A:     defb      1               ; transpose on
        defb      255,243, 0 * 2
        defw    frq_721

patch_112B:     defb      1               ; transpose on
        defb      255,37h, 1 + 36 * 2     ; 311
        defw    frq_214

;--- GM 113 = Agogo ---

patch_113:      defb      0               ; transpose off
        defb      255,11, 12 * 2
        defw    frq_217

;--- GM 114 = Steel Drums ---

patch_114A:     defb      0               ; transpose off
        defb      255,254, 12 * 2
        defw    frq_317

patch_114B:     defb      0               ; transpose off
        defb      255,1, 1 + 36 * 2        ; tone 257
        defw    frq_195

;--- GM 115 = Woodefblock ---

patch_115:      defb      0               ; transpose off
        defb      255,44, 24 * 2
        defw    frq_355

;--- GM 116 = Taiko Drum ---

patch_116:      defb      0               ; transpose off
        defb      255,62, 12 * 2
        defw    frq_217

;--- GM 117 = Melodic Tom ---

patch_117:      defb      0               ; transpose off
        defb      255,199, 36 * 2
        defw    frq_616

;--- GM 118 = Synth Drum ---

patch_118:      defb      0               ; transpose off
        defb      255,38, 24 * 2
        defw    frq_27

;--- GM 119 = Reverse Cymbal ---

patch_119:      defb      0               ; transpose off
        defb      255,49, 36 * 2
        defw    frq_143

;--- GM 120 = Gtr Fret Noise ---

patch_120:      defb      0               ; transpose off
        defb      255,38h, 1 + 24 * 2      ; tone 312
        defw    frq_354

;--- GM 121 = Breath Noise ---

patch_121:      defb      0               ; transpose off
        defb      255,25h, 1 + 24 * 2      ; tone 293
        defw    frq_733

;--- GM 122 = Sea Shore ---

patch_122A:     defb      0               ; transpose off
        defb      255,8, 36 * 2
        defw    frq_264
patch_122B:     defb      0               ; transpose off
        defb      255,55, 48 * 2
        defw    frq_203

;--- GM 124 = Telephone / Bird ---

patch_124:      defb      0               ; transpose off
        defb      48, 3, 36 * 2
        defw    frq_27
        defb      255, 9, 36 * 2
                defw  frq_203

;--- GM 125 = Helicopter ---

patch_125A:     defb      0               ; transpose off
        defb      255, 1, 24 * 2
        defw    frq_560
patch_125B:     defb      0               ; transpose off
        defb      255, 55, 36 * 2
        defw    frq_462

;--- GM 126 = Applause ---

patch_126A:     defb      0               ; transpose off
        defb      255, 54, 24 * 2
        defw    frq_216
patch_126B:     defb      0               ; transpose off
        defb      255, 54, 24 * 2
        defw    frq_462

;--- GM 127 = Gunshot / Snare ---

patch_127:      defb      0               ; transpose off
        defb      48,39h, 1 + 24 * 2        ; tone 313
        defw    frq_203
        defb      255, 120, 0 + 24 * 2
        defw    frq_203

;--- Drum patch 1 ---

drum_1: defb      0               ; transpose off
        defb      48,17, 24 * 2           ; tone 17
        defw    frq_264
        defb      255,191, 36 * 2         ; tone 191
        defw    frq_264

;--- Drum patch 2 ---

drum_2: defb      0               ; transpose off
        defb      48,209, 24 * 2          ; tone 209
        defw    frq_908
        defb      255,197, 24 * 2         ; tone 197
        defw    frq_908

;--- Drum patch 3 ---

drum_3: defb      0               ; transpose off
        defb      255,10, 24 * 2           ; tone 10
        defw    frq_654

;--- Drum patch 4 ---

drum_4: defb      0               ; transpose off
        defb      255,28, 24 * 2           ; tone 28
        defw    frq_187

;--- Drum patch 5 ---

drum_5: defb      0               ; transpose off
        defb      255,31, 24 * 2           ; tone 31
        defw    frq_908

;--- Drum patch 6 ---

drum_6: defb      0               ; transpose off
        defb      255,156, 24 * 2          ; tone 156
        defw    frq_27

;--- Drum patch 7 ---

drum_7: defb      0               ; transpose off
        defb      255,128+OWNTONES,1 + 24 * 2           ; tone 49
        defw    frq_24

;--- Drum patch 8 ---

drum_8: defb      0               ; transpose off
        defb      255,157, 24 * 2          ; tone 157
        defw    frq_737

;--- Midi Drum patch ---

gmdrm_b3:       defw    16
        defb    018h,0f2h

gmdrm_c4:       defw      17
        defb      018h,0f2h
gmdrm_cp4:      defw      210
        defb      0f6h,0
gmdrm_d4:       defw      209
        defb      0f4h,0f6h
gmdrm_dp4:      defw      10
        defb      02ah,0f5h
gmdrm_e4:       defw      209
        defb      038h,003h
gmdrm_f4:       defw      200
        defb      060h,0
gmdrm_fp4:      defw      121
        defb      05ch,1
gmdrm_g4:       defw      200
        defb      0a8h,2
gmdrm_gp4:      defw      123
        defb      034h,5
gmdrm_a4:       defw      200
        defb      046h,4
gmdrm_ap4:      defw      122
        defb      034h,5
gmdrm_b4:       defw      199
        defb      00ah,3

gmdrm_c5:       defw      199
        defb      0f4h,4
gmdrm_cp5:      defw      384 + OWNTONES
        defb      032h,0
gmdrm_d5:       defw      199
        defb      090h,010h
gmdrm_dp5:      defw      46
        defb      0ceh,1
gmdrm_e5:       defw      122
        defb      056h,0e1h
gmdrm_f5:       defw      33
        defb      03ch,1
gmdrm_fp5:      defw      37
        defb      0bah,0
gmdrm_g5:       defw      384 + OWNTONES
        defb      0cah,5
gmdrm_gp5:      defw      29
        defb      0feh,0f6h
gmdrm_a5:       defw      384 + OWNTONES
        defb      070h,3
gmdrm_ap5:      defw      157
        defb      0cah,0f5h
gmdrm_b5:       defw      46
        defb      074h,5

gmdrm_c6:       defw      28
        defb      076h,1
gmdrm_cp6:      defw      28
        defb      032h,0
gmdrm_d6:       defw      30
        defb      0dah,0f4h
gmdrm_dp6:      defw      31
        defb      0feh,0f6h
gmdrm_e6:       defw      31
        defb      0fch,0f2h
gmdrm_f6:       defw      156
        defb      03eh,0
gmdrm_fp6:      defw      156
        defb      0d0h,0f4h
gmdrm_g6:       defw      11
        defb      016h,0
gmdrm_gp6:      defw      11
        defb      03ch,0f4h
gmdrm_a6:       defw      47
        defb      050h,3
gmdrm_ap6:      defw      48
        defb      04ah,0
gmdrm_b6:       defw      45
        defb      038h,0f3h

gmdrm_c7:       defw      044h
        defb      053h,0f2h
gmdrm_cp7:      defw      36
        defb      074h,5
gmdrm_d7:       defw      36
        defb      048h,0f6h
gmdrm_dp7:      defw      32
        defb      050h,0f5h
gmdrm_e7:       defw      44
        defb      028h,0f2h
gmdrm_f7:       defw      44
        defb      05ch,0e7h
gmdrm_fp7:      defw      34
        defb      022h,010h
gmdrm_g7:       defw      35
        defb      0c0h,0f6h
gmdrm_gp7:      defw      50
        defb      050h,0
gmdrm_a7:       defw      50
        defb      054h,0
gmdrm_ap7:      defw      191
        defb      018h,0f2h
gmdrm_b7:       defw      197
        defb      018h,0f7h
gmdrm_c8:       defw      197
        defb      038h,003h
gmdrm_cp8:      defw      208
        defb      018h,0f2h
gmdrm_d8:       defw      120
        defb      018h,0f2h


frq_0:     defw 0,61,125,194,266,343,424,510,601,698,801,909
frq_1:     defw 1,62,127,195,268,345,426,512,604,700,803,912
frq_8:     defw 8,69,134,203,276,353,435,522,614,711,814,924
frq_9:     defw 9,70,135,204,277,355,437,524,616,713,816,926
frq_10:    defw 10,71,136,205,278,356,438,525,617,714,818,927
frq_15:    defw 15,77,143,212,286,364,446,533,626,724,828,938
frq_20:    defw 20,82,148,217,291,369,452,540,633,731,836,946
frq_21:    defw 21,83,148,218,292,370,453,542,635,733,838,949
frq_22:    defw 22,84,150,219,293,372,455,542,636,734,839,950

frq_24:    defw 24,86,152,222,296,375,457,545,639,737,842,953
frq_26:    defw 26,88,154,224,299,377,461,549,642,741,846,958
frq_27:    defw 27,89,155,225,300,378,462,550,644,743,848,959
frq_45:    defw 45,109,176,248,324,403,488,578,673,774,881,995
frq_46:    defw 46,110,177,248,324,404,489,579,674,775,882,996

frq_69:    defw 69,134,203,276,353,435,522,614,711,815,924,8+2048
frq_70:    defw 70,135,204,277,354,436,523,615,712,815,925,8+2048
frq_73:    defw 73,139,208,281,359,441,528,620,718,822,932,12+2048
frq_75:    defw 75,141,210,283,361,444,531,623,721,825,935,14+2048
frq_79:    defw 79,145,214,288,366,449,536,629,727,831,942,17+2048

frq_82:    defw 82,147,217,291,369,452,540,633,731,835,946,20+2048
frq_84:    defw 84,150,219,293,372,455,543,636,734,839,950,22+2048
frq_88:    defw 88,154,224,298,377,460,548,642,741,846,957,25+2048
frq_89:    defw 89,155,225,299,378,461,550,643,742,847,959,26+2048
frq_91:    defw 91,157,228,302,381,465,553,647,746,851,963,29+2048

frq_94:    defw 94,161,231,306,385,469,557,651,751,857,968,31+2048

frq_96:    defw 96,162,233,308,387,471,560,654,753,859,971,33+2048
frq_97:    defw 97,164,235,309,389,473,562,656,756,862,974,34+2048
frq_98:    defw 98,165,236,311,390,474,563,657,757,863,976,35+2048
frq_113:   defw 113,180,252,328,408,493,583,679,780,887,1001,49+2048
frq_118:   defw 118,186,257,334,415,501,591,687,789,897,1011,54+2048

frq_135:   defw 135,204,277,355,437,524,616,713,816,926,9+2048,70+2048
frq_141:   defw 141,210,283,361,443,530,623,721,825,935,13+2048,75+2048
frq_143:   defw 143,212,286,363,446,533,626,724,828,938,15+2048,77+2048

frq_155:   defw 155,225,299,376,461,549,643,742,847,959,26+2048,89+2048
frq_156:   defw 156,226,300,379,462,551,644,744,849,960,27+2048,89+2048

frq_167:   defw 167,237,312,392,476,565,660,760,866,978,37+2048,100+2048
        
frq_184:   defw 184,256,332,413,499,589,685,787,894,1008,53+2048,117+2048

frq_187:   defw   187,259,336,417,502,593,689,791,899,1013,55+2048,119+2048
frq_188:   defw   188,260,336,417,503,593,690,792,899,1014,56+2048,120+2048

frq_191:   defw   191,263,340,421,507,598,694,796,905,1019,58+2048,123+2048
frq_192:   defw   192,264,341,422,508,599,696,798,906,1021,59+2048,124+2048
frq_195:   defw   195,267,344,425,512,603,700,802,911,1+2048,62+2048,126+2048

frq_202:   defw   202,275,352,434,521,613,710,813,922,7+2048,68+2048,133+2048
frq_203:   defw   203,276,353,435,522,614,711,815,924,8+2048,69+2048,134+2048

frq_204:   defw   204,277,354,436,523,615,712,815,925,8+2048,70+2048,135+2048
frq_206:   defw   206,279,356,438,525,618,715,819,928,10+2048,72+2048,137+2048
frq_208:   defw   208,281,359,441,528,621,718,822,932,12+2048,74+2048,139+2048
frq_211:   defw  211,284,362,445,532,624,722,826,936,14+2048,76+2048,142+2048
frq_214:   defw  214,288,366,449,536,629,727,831,942,17+2048,79+2048,145+2048
frq_215:   defw  215,289,367,450,538,630,729,833,943,18+2048,80+2048,146+2048
frq_216:   defw  216,289,368,450,538,631,729,834,944,19+2048,80+2048,146+2048
frq_217:   defw  217,291,369,452,540,633,731,835,946,20+2048,82+2048,147+2048
frq_219:   defw  219,293,372,455,543,636,734,839,950,22+2048,84+2048,150+2048
frq_220:   defw  220,294,373,456,544,637,736,841,951,22+2048,85+2048,151+2048
frq_221:   defw  221,296,374,457,545,639,737,842,953,23+2048,86+2048,152+2048
frq_228:   defw  228,302,381,465,553,647,747,852,963,29+2048,91+2048,158+2048
frq_231:   defw  231,305,384,468,557,651,750,856,967,31+2048,94+2048,160+2048
frq_242:   defw  242,317,397,481,571,666,766,873,985,40+2048,104+2048,171+2048
frq_254:   defw  254,330,410,495,586,681,783,890,1004,50+2048,114+2048,182+2048
frq_261:   defw  261,337,418,504,595,691,793,901,1016,56+2048,121+2048,189+2048
frq_264:   defw  264,341,422,508,599,695,797,906,1020,59+2048,123+2048,192+2048
frq_273:   defw  273,350,432,519,610,708,810,920,6+2048,67+2048,132+2048,200+2048
frq_274:   defw  274,351,433,519,611,708,811,920,6+2048,67+2048,132+2048,201+2048
frq_282:   defw  282,360,442,529,621,719,823,933,13+2048,74+2048,139+2048,209+2048
frq_286:   defw  286,363,446,533,626,724,828,938,15+2048,77+2048,143+2048,212+2048
frq_287:   defw  287,365,447,535,627,726,830,940,16+2048,78+2048,144+2048,213+2048
frq_288:   defw  288,366,449,536,629,727,831,942,17+2048,79+2048,145+2048,214+2048
frq_290:   defw  290,368,451,539,632,730,835,945,19+2048,81+2048,147+2048,216+2048
frq_291:   defw  291,370,453,540,633,731,836,946,20+2048,82+2048,148+2048,217+2048
frq_299:   defw  299,378,461,550,643,742,848,959,26+2048,89+2048,155+2048,225+2048
frq_311:   defw  311,391,475,564,658,758,864,977,36+2048,99+2048,166+2048,236+2048
frq_314:   defw  314,394,478,567,662,762,868,981,38+2048,101+2048,168+2048,239+2048
frq_317:   defw  317,397,481,571,666,766,873,986,41+2048,104+2048,171+2048,242+2048
frq_333:   defw  333,414,500,590,686,788,896,1010,53+2048,117+2048,185+2048,257+2048
frq_335:   defw  335,416,502,593,689,791,899,1013,55+2048,119+2048,187+2048,259+2048
frq_338:   defw  338,419,505,596,692,794,902,1016,56+2048,121+2048,189+2048,261+2048
frq_340:   defw  340,421,507,598,694,796,905,1019,58+2048,123+2048,191+2048,263+2048
frq_341:   defw  341,422,508,599,696,798,906,1021,59+2048,124+2048,192+2048,264+2048
frq_342:   defw  342,423,509,600,697,799,907,1022,60+2048,125+2048,193+2048,265+2048
frq_343:   defw  343,425,511,602,699,801,910,0+2048,61+2048,126+2048,195+2048,267+2048
frq_345:   defw  345,427,513,604,701,804,913,2+2048,63+2048,127+2048,196+2048,268+2048
frq_348:   defw  348,429,516,607,704,806,915,3+2048,64+2048,129+2048,198+2048,271+2048
frq_350:   defw  350,430,518,609,705,808,917,4+2048,65+2048,130+2048,199+2048,272+2048
frq_352:   defw  352,434,521,613,710,813,922,7+2048,68+2048,133+2048,202+2048,275+2048
frq_354:   defw  354,436,523,615,712,815,925,8+2048,70+2048,135+2048,204+2048,277+2048
frq_355:   defw  355,437,524,616,713,816,926,9+2048,70+2048,135+2048,204+2048,277+2048
frq_356:   defw  356,438,525,617,714,818,927,10+2048,71+2048,136+2048,205+2048,278+2048
frq_357:   defw  357,439,526,618,716,820,929,11+2048,72+2048,137+2048,206+2048,279+2048
frq_358:   defw  358,441,528,620,718,821,931,12+2048,73+2048,138+2048,207+2048,281+2048
frq_360:   defw  360,443,530,622,720,824,934,13+2048,75+2048,140+2048,209+2048,283+2048
frq_361:   defw  361,443,531,623,722,825,935,14+2048,76+2048,141+2048,211+2048,284+2048
frq_363:   defw  363,445,533,625,723,827,937,15+2048,77+2048,142+2048,211+2048,285+2048
frq_364:   defw  364,447,534,627,725,829,939,16+2048,78+2048,144+2048,213+2048,286+2048
frq_365:   defw  365,447,535,627,726,830,940,16+2048,78+2048,144+2048,213+2048,287+2048
frq_366:   defw  366,449,536,629,727,831,942,17+2048,79+2048,145+2048,214+2048,288+2048
frq_367:   defw  367,450,537,630,729,833,943,18+2048,80+2048,146+2048,216+2048,289+2048
frq_369:   defw  369,452,540,633,731,835,946,20+2048,82+2048,147+2048,217+2048,291+2048
frq_370:   defw  370,453,541,634,732,837,947,20+2048,82+2048,148+2048,218+2048,292+2048
frq_373:   defw  373,457,545,638,737,841,952,23+2048,85+2048,151+2048,221+2048,295+2048
frq_378:   defw  378,462,550,644,743,848,959,27+2048,89+2048,155+2048,225+2048,300+2048
frq_379:   defw  378,463,551,645,744,849,960,27+2048,90+2048,156+2048,226+2048,300+2048
frq_381:   defw  381,465,553,647,747,852,963,29+2048,91+2048,158+2048,228+2048,302+2048
frq_385:   defw  385,469,558,652,752,857,969,32+2048,95+2048,161+2048,232+2048,306+2048
frq_433:   defw  433,520,612,709,812,921,7+2048,68+2048,133+2048,202+2048,274+2048,352+2048
frq_434:   defw  434,521,613,710,813,922,7+2048,68+2048,133+2048,202+2048,275+2048,352+2048
frq_436:   defw  436,523,615,712,815,925,8+2048,70+2048,135+2048,204+2048,277+2048,354+2048
frq_442:   defw  442,529,621,719,823,933,12+2048,74+2048,139+2048,209+2048,282+2048,360+2048
frq_443:   defw  443,530,622,720,824,934,13+2048,75+2048,140+2048,209+2048,283+2048,360+2048
frq_445:   defw  445,532,624,723,826,936,14+2048,76+2048,142+2048,211+2048,284+2048,362+2048
frq_448:   defw  448,535,628,726,830,941,17+2048,79+2048,144+2048,214+2048,287+2048,365+2048
frq_450:   defw  450,538,631,730,834,944,19+2048,81+2048,146+2048,216+2048,290+2048,368+2048
frq_455:   defw  455,543,637,735,840,951,22+2048,84+2048,150+2048,220+2048,294+2048,372+2048
frq_459:   defw  459,547,640,739,844,955,24+2048,87+2048,153+2048,223+2048,297+2048,375+2048
frq_460:   defw  460,548,641,740,845,957,25+2048,88+2048,154+2048,224+2048,298+2048,376+2048
frq_461:   defw  461,549,642,741,846,958,26+2048,88+2048,154+2048,224+2048,299+2048,377+2048
frq_462:   defw  462,550,644,743,848,959,27+2048,89+2048,155+2048,225+2048,300+2048,378+2048
frq_480:   defw  480,569,664,764,870,983,39+2048,102+2048,169+2048,240+2048,316+2048,395+2048
frq_507:   defw  507,598,694,796,905,1019,58+2048,123+2048,191+2048,263+2048,340+2048,421+2048
frq_508:   defw  508,599,695,797,905,1019,58+2048,123+2048,191+2048,264+2048,341+2048,422+2048
frq_519:   defw  519,611,708,811,920,6+2048,67+2048,132+2048,201+2048,274+2048,351+2048,433+2048
frq_531:   defw  531,623,721,825,935,14+2048,76+2048,141+2048,210+2048,284+2048,362+2048,444+2048
frq_532:   defw  532,624,722,826,936,14+2048,76+2048,141+2048,211+2048,284+2048,362+2048,445+2048
frq_538:   defw  538,631,730,834,944,19+2048,81+2048,146+2048,216+2048,290+2048,368+2048,451+2048
frq_545:   defw  545,639,737,842,953,23+2048,86+2048,152+2048,221+2048,296+2048,374+2048,457+2048
frq_548:   defw  548,642,741,846,957,25+2048,88+2048,154+2048,224+2048,298+2048,377+2048,460+2048
frq_550:   defw  550,643,742,848,959,26+2048,89+2048,155+2048,225+2048,299+2048,378+2048,461+2048
frq_552:   defw  552,645,745,850,961,28+2048,90+2048,156+2048,227+2048,301+2048,380+2048,463+2048
frq_555:   defw  555,648,748,853,965,30+2048,92+2048,159+2048,229+2048,304+2048,383+2048,467+2048
frq_556:   defw  556,650,749,855,967,30+2048,93+2048,160+2048,231+2048,305+2048,384+2048,467+2048
frq_557:   defw  557,651,750,856,967,31+2048,94+2048,160+2048,231+2048,305+2048,384+2048,468+2048
frq_558:   defw  558,652,752,857,969,32+2048,95+2048,161+2048,232+2048,306+2048,385+2048,469+2048
frq_559:   defw  559,653,753,858,970,32+2048,95+2048,162+2048,232+2048,307+2048,386+2048,470+2048
frq_560:   defw  560,654,753,859,971,33+2048,96+2048,162+2048,233+2048,308+2048,387+2048,471+2048
frq_579:   defw  579,674,775,882,996,46+2048,110+2048,177+2048,248+2048,324+2048,404+2048,489+2048
frq_616:   defw  616,713,816,926,9+2048,70+2048,135+2048,204+2048,277+2048,355+2048,437+2048,524+2048
frq_627:   defw  627,725,829,939,16+2048,78+2048,143+2048,213+2048,286+2048,364+2048,447+2048,534+2048
frq_630:   defw  630,729,833,943,18+2048,80+2048,146+2048,215+2048,289+2048,367+2048,450+2048,538+2048
frq_639:   defw  639,738,843,954,24+2048,86+2048,152+2048,222+2048,296+2048,375+2048,458+2048,546+2048
frq_641:   defw  641,740,845,957,25+2048,88+2048,154+2048,224+2048,298+2048,376+2048,460+2048,548+2048
frq_645:   defw  645,744,849,960,27+2048,90+2048,156+2048,226+2048,300+2048,380+2048,463+2048,552+2048
frq_650:   defw  650,749,855,967,30+2048,93+2048,160+2048,230+2048,305+2048,384+2048,467+2048,556+2048
frq_653:   defw  653,753,858,970,32+2048,95+2048,162+2048,232+2048,307+2048,386+2048,470+2048,559+2048
frq_654:   defw  654,754,859,971,33+2048,96+2048,163+2048,233+2048,308+2048,387+2048,471+2048,560+2048
frq_677:   defw  677,778,886,999,48+2048,112+2048,179+2048,251+2048,326+2048,407+2048,492+2048,582+2048
frq_679:   defw  679,781,888,1002,49+2048,113+2048,180+2048,252+2048,328+2048,408+2048,494+2048,584+2048
frq_698:   defw  698,801,909,0+2048,61+2048,125+2048,194+2048,266+2048,343+2048,424+2048,510+2048,601+2048
frq_701:   defw  701,805,913,2+2048,63+2048,127+2048,196+2048,268+2048,345+2048,427+2048,513+2048,604+2048
frq_704:   defw  704,807,916,4+2048,65+2048,130+2048,198+2048,271+2048,348+2048,429+2048,516+2048,607+2048
frq_708:   defw  708,810,920,6+2048,67+2048,132+2048,200+2048,273+2048,350+2048,432+2048,519+2048,610+2048
frq_715:   defw  715,819,928,10+2048,72+2048,137+2048,206+2048,279+2048,356+2048,438+2048,525+2048,618+2048
frq_721:   defw  721,825,935,13+2048,75+2048,141+2048,210+2048,283+2048,361+2048,443+2048,530+2048,623+2048
frq_726:   defw  726,830,941,17+2048,79+2048,144+2048,214+2048,287+2048,365+2048,448+2048,535+2048,628+2048
frq_727    defw  727,831,942,18+2048,80+2048,145+2048,215+2048,288+2048,367+2048,449+2048,536+2048,629+2048
frq_733:   defw  733,838,949,21+2048,83+2048,149+2048,219+2048,293+2048,371+2048,454+2048,542+2048,635+2048
frq_737:   defw  737,842,953,23+2048,86+2048,152+2048,221+2048,296+2048,374+2048,457+2048,545+2048,639+2048
frq_750:   defw  750,855,967,31+2048,93+2048,160+2048,230+2048,305+2048,384+2048,467+2048,556+2048,650+2048
frq_775:   defw  775,882,996,46+2048,110+2048,177+2048,248+2048,324+2048,404+2048,489+2048,579+2048,674+2048
frq_809:   defw  809,918,5+2048,66+2048,131+2048,199+2048,272+2048,349+2048,431+2048,517+2048,609+2048,706+2048
frq_810:   defw  810,919,5+2048,66+2048,131+2048,200+2048,273+2048,350+2048,431+2048,518+2048,610+2048,707+2048
frq_811:   defw  811,920,6+2048,67+2048,132+2048,201+2048,274+2048,351+2048,433+2048,519+2048,611+2048,708+2048
frq_815:   defw  815,925,8+2048,70+2048,135+2048,204+2048,277+2048,354+2048,436+2048,523+2048,615+2048,712+2048
frq_820:   defw  820,929,11+2048,72+2048,137+2048,206+2048,280+2048,357+2048,439+2048,526+2048,618+2048,716+2048
frq_822:   defw  822,932,12+2048,73+2048,139+2048,208+2048,281+2048,359+2048,441+2048,528+2048,620+2048,718+2048
frq_823:   defw  823,933,13+2048,74+2048,139+2048,209+2048,282+2048,360+2048,442+2048,529+2048,621+2048,719+2048
frq_824:   defw  824,934,13+2048,75+2048,140+2048,209+2048,283+2048,360+2048,443+2048,530+2048,622+2048,720+2048
frq_828:   defw  828,938,15+2048,77+2048,143+2048,212+2048,286+2048,363+2048,446+2048,533+2048,626+2048,724+2048
frq_831:   defw  831,942,17+2048,79+2048,145+2048,214+2048,288+2048,366+2048,449+2048,536+2048,629+2048,727+2048
frq_832:   defw  832,942,18+2048,80+2048,145+2048,215+2048,288+2048,367+2048,449+2048,537+2048,630+2048,728+2048
frq_833:   defw  833,943,18+2048,80+2048,146+2048,215+2048,289+2048,367+2048,450+2048,538+2048,630+2048,729+2048
frq_835:   defw  835,946,20+2048,82+2048,147+2048,217+2048,291+2048,369+2048,452+2048,540+2048,633+2048,731+2048
frq_842:   defw  842,953,23+2048,86+2048,152+2048,222+2048,296+2048,374+2048,457+2048,545+2048,639+2048,737+2048
frq_843:   defw  843,954,24+2048,86+2048,152+2048,222+2048,296+2048,375+2048,458+2048,546+2048,639+2048,738+2048
frq_844:   defw  844,955,24+2048,87+2048,153+2048,223+2048,297+2048,375+2048,459+2048,547+2048,640+2048,739+2048
frq_847:   defw  847,959,26+2048,89+2048,155+2048,225+2048,299+2048,378+2048,461+2048,550+2048,643+2048,742+2048
frq_852:   defw  852,964,29+2048,92+2048,158+2048,228+2048,303+2048,382+2048,465+2048,554+2048,648+2048,747+2048
frq_874:   defw  874,986,41+2048,104+2048,171+2048,243+2048,318+2048,398+2048,482+2048,572+2048,667+2048,767+2048
frq_908:   defw  908,1023,60+2048,125+2048,193+2048,265+2048,342+2048,423+2048,509+2048,601+2048,697+2048,800+2048
frq_909:   defw  909,0+2048,61+1025,125+2048,194+2048,266+2048,343+2048,424+2048,510+2048,601+2048,698+2048,801+2048
frq_916:   defw  916,4+2048,65+2048,130+2048,198+2048,271+2048,347+2048,429+2048,515+2048,607+2048,704+2048,807+2048
frq_918:   defw  918,5+2048,66+2048,131+2048,199+2048,272+2048,349+2048,431+2048,517+2048,609+2048,706+2048,809+2048
frq_920:   defw  920,6+2048,67+2048,132+2048,201+2048,274+2048,351+2048,433+2048,519+2048,611+2048,708+2048,811+2048
frq_921:   defw  921,7+2048,68+2048,133+2048,202+2048,274+2048,352+2048,433+2048,520+2048,612+2048,709+2048,812+2048
frq_925:   defw  925,8+2048,70+2048,135+2048,204+2048,277+2048,354+2048,436+2048,523+2048,615+2048,712+2048,815+2048
frq_926:   defw  926,9+2048,70+2048,135+2048,204+2048,277+2048,355+2048,437+2048,523+2048,615+2048,713+2048,816+2048
frq_927:   defw  927,10+2048,71+2048,136+2048,205+2048,278+2048,356+2048,438+2048,525+2048,617+2048,715+2048,818+2048
frq_929:   defw  929,11+2048,72+2048,137+2048,206+2048,280+2048,357+2048,439+2048,526+2048,618+2048,716+2048,820+2048
frq_931:   defw  931,12+2048,73+2048,138+2048,208+2048,281+2048,358+2048,441+2048,528+2048,620+2048,718+2048,821+2048
frq_935:   defw  935,13+2048,75+2048,141+2048,210+2048,283+2048,361+2048,443+2048,530+2048,623+2048,721+2048,825+2048
frq_936:   defw  936,14+2048,76+2048,142+2048,211+2048,284+2048,362+2048,444+2048,532+2048,624+2048,722+2048,826+2048
frq_937:   defw  937,15+2048,77+2048,142+2048,211+2048,285+2048,363+2048,445+2048,533+2048,625+2048,723+2048,827+2048
frq_939:   defw  939,16+2048,78+2048,143+2048,213+2048,286+2048,364+2048,447+2048,534+2048,627+2048,725+2048,829+2048
frq_941:   defw  941,17+2048,79+2048,144+2048,214+2048,287+2048,365+2048,448+2048,535+2048,628+2048,726+2048,830+2048
frq_942:   defw  942,18+2048,80+2048,145+2048,215+2048,288+2048,367+2048,449+2048,537+2048,630+2048,728+2048,832+2048
frq_944:   defw  944,19+2048,80+2048,146+2048,216+2048,289+2048,368+2048,450+2048,538+2048,631+2048,729+2048,834+2048
frq_949:   defw  949,21+2048,83+2048,149+2048,218+2048,292+2048,371+2048,454+2048,542+2048,635+2048,733+2048,838+2048
frq_950:   defw  950,22+2048,84+2048,150+2048,219+2048,293+2048,372+2048,455+2048,543+2048,636+2048,734+2048,839+2048
frq_951:   defw  951,22+2048,85+2048,151+2048,220+2048,294+2048,372+2048,456+2048,543+2048,637+2048,736+2048,841+2048
frq_952:   defw  952,23+2048,85+2048,151+2048,221+2048,295+2048,373+2048,456+2048,544+2048,638+2048,736+2048,841+2048
frq_953:   defw  953,23+2048,86+2048,152+2048,221+2048,296+2048,374+2048,457+2048,545+2048,639+2048,737+2048,842+2048
frq_964:   defw  964,29+2048,92+2048,158+2048,228+2048,303+2048,382+2048,466+2048,554+2048,648+2048,747+2048,852+2048
frq_966:   defw  966,30+2048,93+2048,159+2048,229+2048,304+2048,383+2048,467+2048,555+2048,649+2048,749+2048,854+2048
frq_969:   defw  969,32+2048,95+2048,161+2048,232+2048,306+2048,385+2048,469+2048,558+2048,652+2048,752+2048,857+2048
frq_974:   defw  974,34+2048,97+2048,164+2048,235+2048,310+2048,389+2048,473+2048,562+2048,656+2048,756+2048,862+2048
frq_977:   defw  977,36+2048,99+2048,166+2048,237+2048,312+2048,391+2048,475+2048,564+2048,659+2048,759+2048,865+2048
frq_978:   defw  978,37+2048,100+2048,167+2048,238+2048,313+2048,392+2048,476+2048,565+2048,660+2048,760+2048,866+2048
frq_1018:  defw  1018,58+2048,122+2048,190+2048,263+2048,339+2048,420+2048,506+2048,597+2048,693+2048,796+2048,904+2048

header_data:    defw    patch_0hdr
        defw    patch_0hdr      ;patch_1
        defw    patch_2Ahdr, patch_2Bhdr
        defw    patch_0hdr
        defw    patch_0hdr      ;patch_3B
        defw    patch_4hdr
        defw    patch_5Ahdr, patch_5Ahdr        ;patch_5B
        defw    patch_0hdr      ;patch_6
        defw    patch_7hdr
        defw    patch_8hdr      ; Celesta
        defw    patch_2Bhdr     ;patch_9
        defw    patch_10Ahdr, patch_10Bhdr
        defw    patch_2Bhdr     ;patch_11
        defw    patch_12hdr
        defw    patch_12hdr     ;patch_13
        defw    patch_14hdr
        defw    patch_15Ahdr, patch_15Bhdr
        defw    patch_16hdr
        defw    patch_17hdr
        defw    patch_18hdr
        defw    patch_19hdr
        defw    patch_20hdr
        defw    patch_21Ahdr, patch_21Bhdr
        defw    patch_22hdr
        defw    patch_23Ahdr, patch_23Bhdr
        defw    patch_24hdr
        defw    patch_25hdr
        defw    patch_2Bhdr     ;patch_26
        defw    patch_27hdr
        defw    patch_2Bhdr     ;patch_28
        defw    patch_27hdr     ;patch_29
        defw    patch_30hdr
        defw    patch_2Bhdr     ;patch_31
        defw    patch_32hdr
        defw    patch_32hdr     ;patch_33
        defw    patch_32hdr     ;patch_34
        defw    patch_35hdr
        defw    patch_36hdr
        defw    patch_37hdr
        defw    patch_38hdr
        defw    patch_38hdr     ;patch_39
        defw    patch_40hdr
        defw    patch_41hdr
        defw    patch_42hdr
        defw    patch_43hdr
        defw    patch_44hdr
        defw    patch_2Bhdr     ;patch_45
        defw    patch_46hdr
        defw    patch_2Bhdr     ;patch_47
        defw    patch_0hdr      ;patch_48
        defw    patch_49hdr
        defw    patch_50Ahdr, patch_50Bhdr
        defw    patch_51Ahdr, patch_51Ahdr      ;patch_51B
        defw    patch_52hdr
        defw    patch_53hdr
        defw    patch_54hdr
        defw    patch_55hdr
        defw    patch_56hdr
        defw    patch_57hdr
        defw    patch_57hdr     ;patch_58
        defw    patch_59hdr
        defw    patch_60hdr
        defw    patch_2Bhdr     ;patch_61
        defw    patch_62Ahdr, patch_62Bhdr
        defw    patch_63Ahdr, patch_63Bhdr
        defw    patch_30hdr     ;patch_64
        defw    patch_65hdr
        defw    patch_36hdr     ;patch_66
        defw    patch_36hdr     ;patch_67
        defw    patch_68hdr
        defw    patch_69hdr
        defw    patch_69hdr     ;patch_70
        defw    patch_71hdr
        defw    patch_72hdr
        defw    patch_72hdr     ;patch_73
        defw    patch_74hdr
        defw    patch_75hdr
        defw    patch_76Ahdr,patch_76Bhdr
        defw    patch_75hdr,patch_77Bhdr        ;patch_77A
        defw    patch_78hdr
        defw    patch_80Ahdr, patch_80Bhdr
        defw    patch_81Ahdr, patch_81Ahdr
        defw    patch_82Ahdr, patch_82Bhdr
        defw    patch_83Ahdr, patch_2Bhdr       ;patch_83B
        defw    patch_84Ahdr, patch_84Bhdr
        defw    patch_85Ahdr, patch_85Bhdr
        defw    patch_86Ahdr, patch_86Bhdr
        defw    patch_27hdr, patch_84Bhdr  ;patch_87Ahdr
        defw    patch_88Ahdr, patch_88Bhdr
        defw    patch_89Ahdr, patch_63Bhdr ;patch_89B
        defw    patch_90Ahdr, patch_90Bhdr
        defw    patch_91Ahdr, patch_91Bhdr
        defw    patch_92Ahdr, patch_92Bhdr
        defw    patch_93Ahdr, patch_93Bhdr
        defw    patch_52hdr, patch_5Ahdr      ;patch_94A/B
        defw    patch_95Ahdr, patch_95Bhdr
        defw    patch_79hdr
        defw    patch_15Bhdr    ;patch_96
        defw    patch_97Ahdr, patch_97Bhdr
        defw    patch_98Ahdr, patch_98Bhdr
        defw    patch_99Ahdr, patch_99Bhdr
        defw    patch_15Bhdr, patch_100Bhdr     ;patch_100A
        defw    patch_102Ahdr, patch_102Bhdr
        defw    patch_103Ahdr, patch_63Bhdr        ;patch_103B
        defw    patch_104hdr
        defw    patch_23Ahdr    ;patch_105
        defw    patch_2Bhdr     ;patch_106
        defw    patch_0hdr      ;patch_107
        defw    patch_109Ahdr,patch_109Bhdr
        defw    patch_23Ahdr    ;patch_108
        defw    patch_69hdr     ;patch_110
        defw    patch_111hdr
        defw    patch_112Ahdr,patch_17hdr       ;patch_112B
        defw    patch_23Ahdr     ;patch_113
        defw    patch_114Ahdr,patch_114Bhdr
        defw    patch_115hdr
        defw    patch_23Ahdr    ;patch_116
        defw    patch_117hdr
        defw    patch_23Ahdr    ;patch_118
        defw    patch_119hdr
        defw    patch_23Ahdr    ;patch_120
        defw    patch_23Ahdr    ;patch_121
        defw    patch_122Ahdr,patch_122Bhdr
        defw    patch_115hdr    ;patch_124
        defw    patch_125Ahdr,patch_125Bhdr
        defw    patch_126Ahdr,patch_126Bhdr
        defw    patch_127hdr
        defw    drum_1hdr
        defw    drum_2hdr
        defw    drum_3hdr
        defw    drum_3hdr       ;drum_4
        defw    drum_3hdr       ;drum_5
        defw    drum_3hdr       ;drum_6
        defw    drum_3hdr       ;drum_7
        defw    drum_8hdr

patch_0hdr:     defb      020h,255
patch_2Ahdr:    defb      020h,0c8h,007h,255
patch_2Bhdr:    defb      028h,255
patch_4hdr:     defb      022h,0c8h,048h,255
patch_5Ahdr:    defb      01bh,255
patch_7hdr:     defb      028h,0c8h,02bh,255
patch_8hdr:     defb      020h,0e0h,3,255
patch_10Ahdr:   defb      020h,098h,0a6h,255
patch_10Bhdr:   defb      020h,098h,0d4h,255
patch_12hdr:    defb      038h,255
patch_14hdr:    defb      021h,0e0h,1,255
patch_15Ahdr:   defb      029h,255
patch_15Bhdr:   defb      02ah,255
patch_16hdr:    defb      03ah,255
patch_17hdr:    defb      03bh,255
patch_18hdr:    defb      039h,255
patch_19hdr:    defb      011h,255
patch_20hdr:    defb      038h,0e0h,1,255
patch_21Ahdr:   defb      022h,0e0h,0,255
patch_21Bhdr:   defb      023h,255
patch_22hdr:    defb      030h,0e0h,2,255
patch_23Ahdr:   defb      038h,255
patch_23Bhdr:   defb      03ah,098h,075h,0B0h,000h,255
patch_24hdr:    defb      028h,0c8h,9,255
patch_25hdr:    defb      028h,098h,0f6h,0b0h,034h,0c8h,9h,255
patch_27hdr:    defb      029h,255
patch_30hdr:    defb      021h,255
patch_32hdr:    defb      018h,255
patch_35hdr:    defb      010h,098h,0f3h,0b0h,063h,0c8h,019h,255
patch_36hdr:    defb      019h,255
patch_37hdr:    defb      020h,098h,0b0h,255
patch_38hdr:    defb      039h,255
patch_40hdr:    defb      03bh,255
patch_41hdr:    defb      03bh,098h,0a3h,255
patch_42hdr:    defb      033h,0c8h,8,255
patch_43hdr:    defb      010h,098h,090h,255
patch_44hdr:    defb      038h,0e0h,6,255
patch_46hdr:    defb      029h,0c8h,7,255
patch_49hdr:    defb      019h,255
patch_50Ahdr:   defb      020h,098h,093h,0b0h,022h,0c8h,06h,255
patch_50Bhdr:   defb      020h,098h,070h,0c8h,006h,255
patch_51Ahdr:   defb      019h,098h,070h,0b0h,000h,0c8h,06h,255
patch_52hdr:    defb      01ah,255
patch_53hdr:    defb      020h,098h,0f7h,0b0h,020h,0c8h,8,255
patch_54hdr:    defb      019h,098h,085h,0b0h,021h,0c8h,7,255
patch_55hdr:    defb      030h,255
patch_56hdr:    defb      032h,255
patch_57hdr:    defb      021h,255
patch_59hdr:    defb      28h,0e0h,1,255
patch_60hdr:    defb      01ah,255
patch_62Ahdr:   defb      018h,255
patch_62Bhdr:   defb      018h,098h,0a5h,0b0h,011h,255
patch_63Ahdr:   defb      026h,255
patch_63Bhdr:   defb      022h,255
patch_65hdr:    defb      019h,0c8h,000bh,255
patch_68hdr:    defb      039h,255
patch_69hdr:    defb      031h,255
patch_71hdr:    defb      029h,255
patch_72hdr:    defb      038h,0e0h,2,255
patch_74hdr:    defb      030h,0e0h,1,255
patch_75hdr:    defb      030h,0e0h,3,255
patch_76Ahdr:   defb      038h,0e0h,1,255
patch_76Bhdr:   defb      0h,255
patch_77Bhdr:   defb      028h,0e0h,2,255
patch_78hdr:    defb      02ch,098h,070h,255
patch_79hdr:    defb      029h,0e0h,1,255
patch_80Ahdr:   defb      038h,098h,0c6h,255
patch_80Bhdr:   defb      008h,098h,0c6h,255
patch_81Ahdr:   defb      030h,098h,0f2h,0b0h,022h,0c8h,00ah,255
patch_82Ahdr:   defb      028h,0e0h,2,255
patch_82Bhdr:   defb      028h,098h,0b0h,0e0h,2,255
patch_83Ahdr:   defb      02ah,0e0h,1,255
patch_84Ahdr:   defb      033h,255
patch_84Bhdr:   defb      02ah,098h,0f2h,0b0h,022h,0c8h,00eh,255
patch_85Ahdr:   defb      02eh,255
patch_85Bhdr:   defb      029h,098h,0f0h,0c8h,00ah,255
patch_86Ahdr:   defb      032h,098h,0f5h,255
patch_86Bhdr:   defb      031h,098h,0b3h,0b0h,022h,0c8h,00bh,255
patch_88Ahdr:   defb      024h,255
patch_88Bhdr:   defb      023h,098h,0a2h,0b0h,014h,0c8h,6,0e0h,1,255
patch_89Ahdr:   defb      02ah,0e0h,2,255
patch_90Ahdr:   defb      023h,098h,0f2h,0b0h,022h,0c8h,007h,0e0h,1,255
patch_90Bhdr:   defb      022h,098h,0e5h,255
patch_91Ahdr:   defb      025h,0c8h,006h,255
patch_91Bhdr:   defb      024h,098h,065h,0b0h,021h,255
patch_92Ahdr:   defb      019h,098h,044h,0e0h,2,255
patch_92Bhdr:   defb      019h,098h,040h,0c8h,6,255
patch_93Ahdr:   defb      00ah,0b0h,003h,0c8h,6,255
patch_93Bhdr:   defb      031h,098h,085h,255
patch_95Ahdr:   defb      019h,098h,015h,0c8h,6,255
patch_95Bhdr:   defb      018h,098h,015h,0c8h,6,255
patch_97Ahdr:   defb      02ah,098h,060h,255
patch_97Bhdr:   defb      02dh,098h,052h,0b0h,014h,0c8h,006h,0e0h,2,255
patch_98Ahdr:   defb      033h,255
patch_98Bhdr:   defb      03bh,098h,085h,0c8h,6,255
patch_99Ahdr:   defb      032h,098h,073h,0b0h,022h,0c8h,6,0e0h,1,255
patch_99Bhdr:   defb      032h,0c8h,7,0e0h,2,255
patch_100Bhdr:  defb      029h,0c8h,6,255
patch_102Ahdr:  defb      02bh,098h,0f5h,0b0h,021h,0c8h,6,255
patch_102Bhdr:  defb      02bh,098h,085h,0b0h,023h,0c8h,7,255
patch_103Ahdr:  defb      02bh,098h,090h,0c8h,6,0e0h,3,255
patch_104hdr:   defb      032h,098h,0f4h,0b0h,015h,0c8h,016h,0e0h,1,255
patch_109Ahdr:  defb      01ch,255
patch_109Bhdr:  defb      019h,255
patch_111hdr:   defb      031h,0c8h,9,255
patch_112Ahdr:  defb      03bh,098h,0d6h,255
patch_114Ahdr:  defb      038h,0e0h,1,255
patch_114Bhdr:  defb      038h,098h,0b0h,0b0h,005h,0e0h,1,255
patch_115hdr:   defb      0,255
patch_117hdr:   defb      038h,0c8h,1,255
patch_119hdr:   defb      038h,0c8h,9,255
patch_122Ahdr:  defb      0,0c8h,4,255
patch_122Bhdr:  defb      0,098h,020h,0b0h,4,0c8h,5,0e0h,0,255
patch_125Ahdr:  defb      8,0c8h,7,255
patch_125Bhdr:  defb      0,0c8h,7,0e0h,0,255
patch_126Ahdr:  defb      0fh,098h,070h,255
patch_126Bhdr:  defb      07h,098h,070h,255
patch_127hdr:   defb      038h,0c8h,3,255
drum_1hdr:      defb      0,098h,0f4h,0b0h,0feh,0c8h,6,255
drum_2hdr:      defb      0,098h,0f5h,0b0h,0f2h,0c8h,6,255
drum_3hdr:      defb      0,098h,0f4h,0b0h,0f2h,0c8h,6,255
drum_8hdr:      defb      0,0b0h,027h,0c8h,6,255

tabdiv12:       defb     -5*16,0,-5*16,2*1,-5*16,2*2,-5*16,2*3,-5*16,2*4,-5*16,2*5
        defb     -5*16,2*6,-5*16,2*7,-5*16,2*8,-5*16,2*9,-5*16,2*10,-5*16,2*11
        defb     -4*16,0,-4*16,2*1,-4*16,2*2,-4*16,2*3,-4*16,2*4,-4*16,2*5
        defb     -4*16,2*6,-4*16,2*7,-4*16,2*8,-4*16,2*9,-4*16,2*10,-4*16,2*11
        defb     -3*16,0,-3*16,2*1,-3*16,2*2,-3*16,2*3,-3*16,2*4,-3*16,2*5
        defb     -3*16,2*6,-3*16,2*7,-3*16,2*8,-3*16,2*9,-3*16,2*10,-3*16,2*11
        defb     -2*16,0,-2*16,2*1,-2*16,2*2,-2*16,2*3,-2*16,2*4,-2*16,2*5
        defb     -2*16,2*6,-2*16,2*7,-2*16,2*8,-2*16,2*9,-2*16,2*10,-2*16,2*11
        defb     -1*16,0,-1*16,2*1,-1*16,2*2,-1*16,2*3,-1*16,2*4,-1*16,2*5
        defb     -1*16,2*6,-1*16,2*7,-1*16,2*8,-1*16,2*9,-1*16,2*10,-1*16,2*11
        defb     0*16,0,0*16,2*1,0*16,2*2,0*16,2*3,0*16,2*4,0*16,2*5
        defb     0*16,2*6,0*16,2*7,0*16,2*8,0*16,2*9,0*16,2*10,0*16,2*11
        defb     1*16,0,1*16,2*1,1*16,2*2,1*16,2*3,1*16,2*4,1*16,2*5
        defb     1*16,2*6,1*16,2*7,1*16,2*8,1*16,2*9,1*16,2*10,1*16,2*11
        defb     2*16,0,2*16,2*1,2*16,2*2,2*16,2*3,2*16,2*4,2*16,2*5
        defb     2*16,2*6,2*16,2*7,2*16,2*8,2*16,2*9,2*16,2*10,2*16,2*11
        defb     3*16,0,3*16,2*1,3*16,2*2,3*16,2*3,3*16,2*4,3*16,2*5
        defb     3*16,2*6,3*16,2*7,3*16,2*8,3*16,2*9,3*16,2*10,3*16,2*11
        defb     4*16,0,4*16,2*1,4*16,2*2,4*16,2*3,4*16,2*4,4*16,2*5
        defb     4*16,2*6,4*16,2*7,4*16,2*8,4*16,2*9,4*16,2*10,4*16,2*11
        defb     5*16,0,5*16,2*1,5*16,2*2,5*16,2*3,5*16,2*4,5*16,2*5
        defb     5*16,2*6,5*16,2*7,5*16,2*8,5*16,2*9,5*16,2*10,5*16,2*11
        defb     6*16,0,6*16,2*1,6*16,2*2,6*16,2*3,6*16,2*4,6*16,2*5
        defb     6*16,2*6,6*16,2*7,6*16,2*8,6*16,2*9,6*16,2*10,6*16,2*11
        defb     7*16,0,7*16,2*1,7*16,2*2,7*16,2*3,7*16,2*4,7*16,2*5
        defb     7*16,2*6,7*16,2*7,7*16,2*8,7*16,2*9,7*16,2*10,7*16,2*11
        defb     8*16,0,8*16,2*1,8*16,2*2,8*16,2*3,8*16,2*4,8*16,2*5
        defb     8*16,2*6,8*16,2*7,8*16,2*8,8*16,2*9,8*16,2*10,8*16,2*11
        defb     9*16,0,9*16,2*1,9*16,2*2,9*16,2*3,9*16,2*4,9*16,2*5
        defb     9*16,2*6,9*16,2*7,9*16,2*8,9*16,2*9,9*16,2*10,9*16,2*11
        defb     10*16,0,10*16,2*1,10*16,2*2,10*16,2*3,10*16,2*4,10*16,2*5
        defb     10*16,2*6,10*16,2*7,10*16,2*8,10*16,2*9,10*16,2*10,10*16,2*11

;OPL4 geluidseffectenafspeler
;In: BC: tone number
;    D: stereo positie
;    E: toonhoogte
play_sfx:	ld	a,b
		cp	255
		ret	z

                ld	hl,sfx_tone_table
                add	hl,bc
                add	hl,bc

		ld	c,(hl)
		inc	hl
		ld	b,(hl)

		ld	hl,sfx_table

init_sfx_lp:    ld	a,(hl)
		cp	255
		jr	z,init_sfx_nt
		cp	b
		jr	nz,init_sfx_lp1
		inc	hl
		ld	a,(hl)
		dec	hl
		cp	c
		ret	z

init_sfx_lp1:	inc	hl
		inc	hl
		inc	hl
		inc	hl
		jr	init_sfx_lp

init_sfx_nt:    ld	(hl),b
		inc	hl
		ld	(hl),c
		inc	hl
		ld	(hl),d
		inc	hl
		ld	(hl),e
		inc	hl
		ld	(hl),255	;end
		ret

sfx_table:	defs	33,255

play_all:   	ld	hl,sfx_table

play_all_lp:    ld	a,(hl)
		cp	255
		jr	z,play_all_end
		ld	b,a	;tone number - MSB
		inc	hl
		ld	c,(hl)	;tone number - LSB
		inc	hl
		ld	d,(hl)	;stereo position
		inc	hl
		ld	e,(hl)	;toonhoogte
		inc	hl
		call	play_sfxs

		jr	play_all_lp

play_all_end:   jp	clear_sfx_table


;In: BC: tone number
;    D: stereo-effect
;    E: toonhoogte
play_sfxs:	push	hl
		ld	hl,sfx_freq_table

		ld	a,e
		add	a,a
		add_hl_a

		ld	a,(current_channel)
		add	a,#68
		out	(#7e),a
		xor	a
		nop        
		out	(#7f),a	;geluid op dit kanaal uit

		ld	a,(current_channel)
		add	a,#20
		out	(#7e),a
		ld	a,(hl)
		or	b
		out	(#7f),a	;bit 8 geluidseffectnummer

		ld	a,(current_channel)
		add	a,#08
		out 	(#7e),a
		ld	a,c
		nop
		out	(#7f),a	;bit 7-0 geluidseffectnummer

		ld	a,(current_channel)
		add	a,#38
		out	(#7e),a
		inc	hl
		ld	a,(hl)
		out	(#7f),a	;octaaf

 		ld	a,(current_channel)
		add	a,#68
		out	(#7e),a
		ld	a,128
		or	d	;stereoeffect eromheen
		out	(#7f),a

		pop	hl
		ld	a,(current_channel)
		inc	a
		ld	(current_channel),a
		cp	24
		ret	c
		ld	a,16
		ld	(current_channel),a
		ret

current_channel:	defb	16 	;huidige sfx-kanaal (=kanaal 17)

;alle geluidseffecten uit
silence:        ld	b,8	;8 kanalen
		ld	c,16

silence_lp:	ld	a,#68
		add	a,c
		out	(#7e),a
		nop
		ld	a,64	;key off, DMP,
		out	(#7f),a	;geluid uit

		ld	a,#50
		add	a,c
		out	(#7e),a
		inc	c
		xor	a
		out	(#7f),a	;volume voluit

		djnz	silence_lp

clear_sfx_table:		
		ld	hl,sfx_table
		ld	de,sfx_table + 1
		ld	bc,32
		ld	(hl),255
		ldir
		ret

sfx_freq_table:
        defw  (-2 * 2048 + 529) * 2	;C 4	<- for tones in SRAM
        defw  (-2 * 2048 + 937) * 2	;E 4
        defw  (-1 * 2048 + 142) * 2	;G 4
        defw  (-1 * 2048 + 529) * 2	;C 5
;-------------
	defw  ( 1 * 2048 + 529) * 2	;??	<- for tones in internal rom
	defw  ( 1 * 2048 + 937) * 2	;??
;-------------
        defw  (-2 * 2048 + 721) * 2 	;D 4
        defw  (-1 * 2048 + 284) * 2	;A 4
        
        defw  (-3 * 2048 + 142) * 2    	;G2
	
	defw  (-2 * 2048 + 142) * 2     ;G3
		 

sfx_tone_table:
	defw	400	;0 - menu select
	defw	401	;1 - bomb
	defw	402	;2 - item pickup
	defw	403	;3 - player dead
	defw	404	;4 - cursor
	defw	405	;5 - kick bomb
	defw	406	;6 - wall build
	defw	407	;7 - throw bomb
	defw	408	;8 - menu back
	defw	409	;9 - enemy hit 1
	defw	410	;10 - enemy hit 2
	defw	411	;11 - enemy hit 3
	defw	412	;12 - bomb bounce
	defw	413	;13 - teleport
	defw	414	;14 - boss fire 1
	defw	415	;15 - boss fire 2
	defw	416	;16 - boss fire 3
	defw	417	;17 - boss hit 1
	defw	418	;18 - boss hit 2
	defw	419	;19 - boss hit 3
	defw	420	;20 - boss  (missile)
	defw	38	;21 - typing effect 1
	defw	38	;22 - typing effect 2
	defw	49	;23 - advance in text effect
	defw	10	;24 - move cursor in textengine
	defw	401	;25 - earthquake (=explosion, low frew)
	defw	383+21	;26 - fireballs
	defw	383+22	;27 - watcha raken
	defw	383+23	;28 - kanon type 1
	defw	383+24	;29 - kanon type 2
	defw	383+27	;30 - deur van watcha
	defw	383+25	;31 - yumi schopt watcha  
	defw	383+26	;32 - watcha stuitert
	defw	383+43	;33 - squirt


































